<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PRIMME 1.2.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="None" href="readme.html#document-readme" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="welcome-to-primme-s-documentation">
<h1>Welcome to PRIMME&#8217;s documentation!<a class="headerlink" href="#welcome-to-primme-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<span id="document-intro"></span><div class="section" id="primme-preconditioned-iterative-multimethod-eigensolver">
<h2>PRIMME: PReconditioned Iterative MultiMethod Eigensolver<a class="headerlink" href="#primme-preconditioned-iterative-multimethod-eigensolver" title="Permalink to this headline">¶</a></h2>
<p>PRIMME, pronounced as <em>prime</em>, finds a number of eigenvalues and their corresponding eigenvectors of a
real symmetric, or complex hermitian matrix A. Largest, smallest and interior
eigenvalues are supported. Preconditioning can be used to accelerate
convergence.
PRIMME is written in C99, but complete interfaces are provided for Fortran 77 and MATLAB.</p>
<div class="section" id="changelog">
<h3>Changelog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h3>
<p>Changes in PRIMME 1.2.2 (released on October 13, 2015):</p>
<ul class="simple">
<li>Fixed wrong symbols in <code class="file docutils literal"><span class="pre">libdprimme.a</span></code> and <code class="file docutils literal"><span class="pre">libzprimme.a</span></code>.</li>
<li><a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets <a class="reference internal" href="readme.html#c.primme_preset_method.JDQMR" title="primme_preset_method.JDQMR"><code class="xref c c-member docutils literal"><span class="pre">JDQMR</span></code></a> instead of <a class="reference internal" href="readme.html#c.primme_preset_method.JDQMR_ETol" title="primme_preset_method.JDQMR_ETol"><code class="xref c c-member docutils literal"><span class="pre">JDQMR_ETol</span></code></a> for preset methods
<a class="reference internal" href="readme.html#c.primme_preset_method.DEFAULT_MIN_TIME" title="primme_preset_method.DEFAULT_MIN_TIME"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_TIME</span></code></a> and <a class="reference internal" href="readme.html#c.primme_preset_method.DYNAMIC" title="primme_preset_method.DYNAMIC"><code class="xref c c-member docutils literal"><span class="pre">DYNAMIC</span></code></a> when seeking interior values.</li>
<li>Fixed compilation of driver with a <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> installation without HYPRE.</li>
<li>Included the content of the environment variable <code class="docutils literal"><span class="pre">INCLUDE</span></code> for compiling the driver.</li>
</ul>
<p>Changes in PRIMME 1.2.1 (released on September 7, 2015):</p>
<ul class="simple">
<li>Added MATLAB interface to full PRIMME functionality.</li>
<li>Support for <a class="reference external" href="http://www.netlib.org/blas/">BLAS</a>/<a class="reference external" href="http://www.netlib.org/lapack/">LAPACK</a> with 64bits integers (<code class="docutils literal"><span class="pre">-DPRIMME_BLASINT_SIZE=64</span></code>).</li>
<li>Simplified configuration of Make_flags and Make_links (removed <code class="docutils literal"><span class="pre">TOP</span></code> variable
and replaced defines <code class="docutils literal"><span class="pre">NUM_SUM</span></code> and <code class="docutils literal"><span class="pre">NUM_IBM</span></code> by <code class="docutils literal"><span class="pre">F77UNDERSCORE</span></code>).</li>
<li>Replaced directories <code class="file docutils literal"><span class="pre">DTEST</span></code> and <code class="file docutils literal"><span class="pre">ZTEST</span></code> by <code class="file docutils literal"><span class="pre">TEST</span></code>, that has:<ul>
<li><code class="file docutils literal"><span class="pre">driver.c</span></code>: read matrices in MatrixMarket format and <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> binary and
call PRIMME with the parameters specified in a file; support
complex arithmetic and MPI and can use <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a> preconditioners.</li>
<li><code class="file docutils literal"><span class="pre">ex*.c</span></code> and <code class="file docutils literal"><span class="pre">ex*.f</span></code>: small, didactic examples of usage in C and Fortran
and in parallel (with <a class="reference external" href="http://www.mcs.anl.gov/petsc/">PETSc</a>).</li>
</ul>
</li>
<li>Fixed a few minor bugs and improved documentation (especially the F77 interface).</li>
<li>Using <a class="reference external" href="http://sphinx-doc.org/">Sphinx</a> to manage documentation.</li>
</ul>
<p>Changes in PRIMME 1.2 (released on December 21, 2014):</p>
<ul>
<li><p class="first">A Fortran compiler is no longer required for building the PRIMME library.
Fortran programs can still be linked to PRIMME&#8217;s F77 interface.</p>
</li>
<li><p class="first">Fixed some uncommon issues with the F77 interface.</p>
</li>
<li><p class="first">PRIMME can be called now multiple times from the same program.</p>
</li>
<li><p class="first">Performance improvements in the QMR inner solver, especially for
complex arithmetic.</p>
</li>
<li><p class="first">Fixed a couple of bugs with the locking functionality.</p>
<ul class="simple">
<li>In certain extreme cases where all eigenvalues of a matrix were needed.</li>
<li>The order of selecting interior eigenvalues.</li>
</ul>
<p>The above fixes have improved robustness and performance.</p>
</li>
<li><p class="first">PRIMME now assigns unique random seeds per parallel process
for up to 4096^3  (140 trillion) processes.</p>
</li>
<li><p class="first">For the <a class="reference internal" href="readme.html#c.primme_preset_method.DYNAMIC" title="primme_preset_method.DYNAMIC"><code class="xref c c-member docutils literal"><span class="pre">DYNAMIC</span></code></a> method, fixed issues with initialization and
synchronization decisions across multiple processes.</p>
</li>
<li><p class="first">Fixed uncommon library interface bugs, coordinated better
setting the method and the user setting of parameters, and improved
the interface in the sample programs and makefiles.</p>
</li>
<li><p class="first">Other performance and documentation improvements.</p>
</li>
</ul>
</div>
<div class="section" id="citing-this-code">
<h3>Citing this code<a class="headerlink" href="#citing-this-code" title="Permalink to this headline">¶</a></h3>
<p>Please cite:</p>
<table class="docutils citation" frame="void" id="r1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[r1]</a></td><td>A. Stathopoulos and J. R. McCombs PRIMME: <em>PReconditioned Iterative
MultiMethod Eigensolver: Methods and software description</em>, ACM
Transaction on Mathematical Software Vol. 37, No. 2, (2010),
21:1-21:30.</td></tr>
</tbody>
</table>
<p>More information on the algorithms and research that led to this
software can be found in the rest of the papers. The work has been
supported by a number of grants from the National Science Foundation.</p>
<table class="docutils citation" frame="void" id="r2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[r2]</a></td><td>A. Stathopoulos, <em>Nearly optimal preconditioned methods for hermitian
eigenproblems under limited memory. Part I: Seeking one eigenvalue</em>, SIAM
J. Sci. Comput., Vol. 29, No. 2, (2007), 481&#8211;514.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[r3]</a></td><td>A. Stathopoulos and J. R. McCombs, <em>Nearly optimal preconditioned
methods for hermitian eigenproblems under limited memory. Part II:
Seeking many eigenvalues</em>, SIAM J. Sci. Comput., Vol. 29, No. 5, (2007),
2162-2188.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[r4]</a></td><td>J. R. McCombs and A. Stathopoulos, <em>Iterative Validation of
Eigensolvers: A Scheme for Improving the Reliability of Hermitian
Eigenvalue Solvers</em>, SIAM J. Sci. Comput., Vol. 28, No. 6, (2006),
2337-2358.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[r5]</a></td><td>A. Stathopoulos, <em>Locking issues for finding a large number of eigenvectors
of hermitian matrices</em>, Tech Report: WM-CS-2005-03, July, 2005.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="license-information">
<h3>License Information<a class="headerlink" href="#license-information" title="Permalink to this headline">¶</a></h3>
<p>PRIMME is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.</p>
<p>PRIMME is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.</p>
<p>You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</p>
</div>
<div class="section" id="contact-information">
<h3>Contact Information<a class="headerlink" href="#contact-information" title="Permalink to this headline">¶</a></h3>
<p>For reporting bugs or questions about functionality contact <a class="reference external" href="http://www.cs.wm.edu/~andreas/">Andreas Stathopoulos</a> by
email, <cite>andreas</cite> at <cite>cs.wm.edu</cite>. See further information in
the webpage <a class="reference external" href="http://www.cs.wm.edu/~andreas/software">http://www.cs.wm.edu/~andreas/software</a> .</p>
</div>
<div class="section" id="directory-structure">
<h3>Directory Structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h3>
<p>The next directories and files should be available:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">COPYING.txt</span></code>, LGPL License;</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">Make_flags</span></code>,  flags to be used by makefiles to compile library and tests;</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">Link_flags</span></code>,  flags needed in making and linking the test programs;</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">PRIMMESRC/</span></code>,  directory with source code in the following subdirectories:</p>
<blockquote>
<div><ul class="simple">
<li><code class="file docutils literal"><span class="pre">COMMONSRC/</span></code>, interface and common functions used by all precision versions;</li>
<li><code class="file docutils literal"><span class="pre">DSRC/</span></code>,      the source code for the double precision <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>;</li>
<li><code class="file docutils literal"><span class="pre">ZSRC/</span></code>,      the source code for the double complex precision <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a>;</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">MEX/</span></code>,          MATLAB interface for PRIMME;</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">TEST/</span></code>,         sample test programs in C and F77, both sequential and parallel;</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">libprimme.a</span></code>,   the PRIMME library (to be made);</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">makefile</span></code>       main make file;</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">readme.txt</span></code>     text version of the documentation;</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">doc/</span></code>           directory with the HTML and PDF versions of the documentation.</p>
</li>
</ul>
</div>
<div class="section" id="making-and-linking">
<h3>Making and Linking<a class="headerlink" href="#making-and-linking" title="Permalink to this headline">¶</a></h3>
<p><code class="file docutils literal"><span class="pre">Make_flags</span></code> has the flags and compilers used to make <code class="file docutils literal"><span class="pre">libprimme.a</span></code>:</p>
<ul class="simple">
<li><cite>CC</cite>, compiler program such as <code class="docutils literal"><span class="pre">gcc</span></code>, <code class="docutils literal"><span class="pre">clang</span></code> or <code class="docutils literal"><span class="pre">icc</span></code>.</li>
<li><cite>CFLAGS</cite>, compiler options such as <code class="docutils literal"><span class="pre">-g</span></code> or <code class="docutils literal"><span class="pre">-O3</span></code>. Also include some of the following
options if required for the <a class="reference external" href="http://www.netlib.org/blas/">BLAS</a> and <a class="reference external" href="http://www.netlib.org/lapack/">LAPACK</a> libraries to be linked:<ul>
<li><code class="docutils literal"><span class="pre">-DF77UNDERSCORE</span></code>, if Fortran appends an underscore to function names
(usually they does).</li>
<li><code class="docutils literal"><span class="pre">-DPRIMME_BLASINT_SIZE=64</span></code>, if the library integers are 64-bit integer (<code class="docutils literal"><span class="pre">kind=8</span></code>) type
(usually they are not).</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When <code class="docutils literal"><span class="pre">-DPRIMME_BLASINT_SIZE=64</span></code> is set the code uses the type <code class="docutils literal"><span class="pre">int64_t</span></code>
supported by the C99 standard. In case the compiler doesn&#8217;t honor the
standard, replace the next lines in <code class="file docutils literal"><span class="pre">PRIMMESRC/COMMONSRC/common_numerical.h</span></code>:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#if !defined(PRIMME_BLASINT_SIZE)</span>
<span class="cp">#  define PRIMME_BLASINT int</span>
<span class="cp">#else</span>
<span class="cp">#  include &lt;stdint.h&gt;</span>
<span class="cp">#  define GENERIC_INT(N) int ## N ## _t</span>
<span class="cp">#  define XGENERIC_INT(N) GENERIC_INT(N)</span>
<span class="cp">#  define PRIMME_BLASINT XGENERIC_INT(PRIMME_BLASINT_SIZE)</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>by the next macro definition with the proper type for an <code class="docutils literal"><span class="pre">int</span></code> of 64 bits:</p>
<div class="last highlight-c"><div class="highlight"><pre><span class="cp">#define PRIMME_BLASINT __int64</span>
</pre></div>
</div>
</div>
<p>After customizing <code class="file docutils literal"><span class="pre">Make_flags</span></code>, type this to generate <code class="file docutils literal"><span class="pre">libprimme.a</span></code>:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">make</span> <span class="n">lib</span>
</pre></div>
</div>
<p>Making can be also done at the command line:</p>
<div class="highlight-c"><div class="highlight"><pre>make lib CC=clang CFLAGS=&#39;-O3&#39;
</pre></div>
</div>
<p><code class="file docutils literal"><span class="pre">Link_flags</span></code> has the flags for linking with external libraries and making the executables
located in <code class="file docutils literal"><span class="pre">TEST</span></code>:</p>
<ul class="simple">
<li><cite>LDFLAGS</cite>, linker flags such as <code class="docutils literal"><span class="pre">-framework</span> <span class="pre">Accelerate</span></code>.</li>
<li><cite>LIBS</cite>, flags to link with libraries (<a class="reference external" href="http://www.netlib.org/blas/">BLAS</a> and <a class="reference external" href="http://www.netlib.org/lapack/">LAPACK</a> are required), such as <code class="docutils literal"><span class="pre">-lprimme</span> <span class="pre">-llapack</span> <span class="pre">-lblas</span> <span class="pre">-lgfortran</span> <span class="pre">-lm</span></code>.</li>
</ul>
<p>After that, type this to compile and execute a simple test:</p>
<div class="highlight-c"><div class="highlight"><pre>$ make test
...
Test passed!
...
Test passed!
</pre></div>
</div>
<p>If it worked, try with other examples in <code class="file docutils literal"><span class="pre">TEST</span></code> (see <code class="file docutils literal"><span class="pre">README</span></code> in <code class="file docutils literal"><span class="pre">TEST</span></code> for more
information about how to compile the driver and the examples).</p>
<p>In case of linking problems check flags in <cite>LDFLAGS</cite> and <cite>LIBS</cite> and consider
to add/remove <code class="docutils literal"><span class="pre">-DF77UNDERSCORE</span></code> from <cite>CFLAGS</cite>. If the execution fails consider
to add/remove <code class="docutils literal"><span class="pre">-DPRIMME_BLASINT_SIZE=64</span></code> from <cite>CFLAGS</cite>.</p>
<p>Full description of actions that <cite>make</cite> can take:</p>
<ul class="simple">
<li><cite>make lib</cite>, builds <code class="file docutils literal"><span class="pre">libprimme.a</span></code>; alternatively:</li>
<li><cite>make libd</cite>, if only <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> is of interest, build <code class="file docutils literal"><span class="pre">libdprimme.a</span></code>:</li>
<li><cite>make libz</cite>, if only <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> is of interest, build <code class="file docutils literal"><span class="pre">libzprimme.a</span></code>;</li>
<li><cite>make test</cite>, build and execute a simple example;</li>
<li><cite>make clean</cite>, removes all <code class="file docutils literal"><span class="pre">*.o</span></code>, <code class="file docutils literal"><span class="pre">a.out</span></code>, and core files from all directories.</li>
</ul>
<div class="section" id="considerations-using-an-ide">
<h4>Considerations using an IDE<a class="headerlink" href="#considerations-using-an-ide" title="Permalink to this headline">¶</a></h4>
<p>PRIMME can be built in other environments such as Anjuta, Eclipse, KDevelop, Qt Creator,
Visual Studio and XCode. To build the PRIMME library do the following:</p>
<ol class="arabic simple">
<li>Create a new project and include the source files under the directory <code class="file docutils literal"><span class="pre">PRIMMESRC</span></code>.</li>
<li>Add the directory <code class="file docutils literal"><span class="pre">PRIMMESRC/COMMONSRC</span></code> as an include directory.</li>
</ol>
<p>To build an example code using PRIMME make sure:</p>
<ul class="simple">
<li>to add a reference for PRIMME, <a class="reference external" href="http://www.netlib.org/blas/">BLAS</a> and <a class="reference external" href="http://www.netlib.org/lapack/">LAPACK</a> libraries;</li>
<li>to add the directory <code class="file docutils literal"><span class="pre">PRIMMESRC/COMMONSRC</span></code> as an include directory.</li>
</ul>
</div>
</div>
<div class="section" id="tested-systems">
<h3>Tested Systems<a class="headerlink" href="#tested-systems" title="Permalink to this headline">¶</a></h3>
<p>PRIMME is primary developed with GNU gcc, g++ and gfortran (versions 4.8 and later).
Many users have reported builds on several other platforms/compilers:</p>
<ul class="simple">
<li>SUSE 13.1 &amp; 13.2</li>
<li>CentOS 6.6</li>
<li>Ubuntu 14.04</li>
<li>MacOS X 10.9 &amp; 10.10</li>
<li>Cygwin &amp; MinGW</li>
<li>Cray XC30</li>
<li>SunOS 5.9, quad processor Sun-Fire-280R, and several other UltraSparcs</li>
<li>AIX 5.2 IBM SP POWER 3+, 16-way SMP, 375 MHz nodes (seaborg at nersc.gov)</li>
</ul>
</div>
</div>
<span id="document-primmec"></span><div class="section" id="c-library-interface">
<h2>C Library Interface<a class="headerlink" href="#c-library-interface" title="Permalink to this headline">¶</a></h2>
<p>The PRIMME interface is composed of the following functions.
To solve real symmetric and Hermitian standard eigenproblems call
respectively:</p>
<pre class="literal-block">
int <a class="reference internal" href="#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme</span></code></a> (double *evals, double *evecs, double *resNorms,
                        primme_params *primme)
int <a class="reference internal" href="#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme</span></code></a> (double *evals, Complex_Z *evecs, double *resNorms,
                        primme_params *primme)
</pre>
<p>Other useful functions:</p>
<pre class="literal-block">
void <a class="reference internal" href="#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize</span></code></a> (primme_params *primme)
int <a class="reference internal" href="#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method</span></code></a> (primme_preset_method method, primme_params *params)
void <a class="reference internal" href="#c.primme_display_params" title="primme_display_params"><code class="xref c c-func docutils literal"><span class="pre">primme_display_params</span></code></a> (primme_params primme)
void <a class="reference internal" href="#c.primme_Free" title="primme_Free"><code class="xref c c-func docutils literal"><span class="pre">primme_Free</span></code></a> (primme_params *primme)
</pre>
<p>PRIMME stores its data on the structure <a class="reference internal" href="readme.html#c.primme_params" title="primme_params"><code class="xref c c-type docutils literal"><span class="pre">primme_params</span></code></a>.
See <a class="reference internal" href="#guide-params"><span>Parameters Guide</span></a> for an introduction about its fields.</p>
<div class="section" id="running">
<h3>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h3>
<p>To use PRIMME, follow this basic steps.</p>
<ol class="arabic">
<li><p class="first">Include:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &quot;primme.h&quot;   </span><span class="cm">/* header file is required to run primme */</span><span class="cp"></span>
</pre></div>
</div>
</li>
<li><p class="first">Initialize a PRIMME parameters structure for default settings:</p>
<pre class="literal-block">
<a class="reference internal" href="readme.html#c.primme_params" title="primme_params"><code class="xref c c-type docutils literal"><span class="pre">primme_params</span></code></a> primme;
<a class="reference internal" href="#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize</span></code></a> (&amp;primme);
</pre>
</li>
<li><p class="first">Set problem parameters (see also <a class="reference internal" href="#guide-params"><span>Parameters Guide</span></a>), and,
optionally, set one of the <a class="reference internal" href="readme.html#c.primme_preset_method" title="primme_preset_method"><code class="xref c c-type docutils literal"><span class="pre">preset</span> <span class="pre">methods</span></code></a>:</p>
<pre class="literal-block">
primme.<a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a> = LaplacianMatrixMatvec; /* MV product */
primme.<a class="reference internal" href="readme.html#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">n</span></code></a> = 100;                   /* set problem dimension */
primme.<a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> = 10;       /* Number of wanted eigenpairs */
ret = <a class="reference internal" href="#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method</span></code></a> (method, &amp;primme);
...
</pre>
</li>
<li><p class="first">Then to solve a real symmetric standard eigenproblems call:</p>
<pre class="literal-block">
ret = <a class="reference internal" href="#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme</span></code></a> (evals, evecs, resNorms, &amp;primme);
</pre>
<p>To solve Hermitian standard eigenproblems call:</p>
<pre class="literal-block">
ret = <a class="reference internal" href="#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme</span></code></a> (evals, evecs, resNorms, &amp;primme);
</pre>
<p>The call arguments are:</p>
<ul class="simple">
<li><cite>evals</cite>, array to return the found eigenvalues;</li>
<li><cite>evecs</cite>, array to return the found eigenvectors;</li>
<li><cite>resNorms</cite>, array to return the residual norms of the found eigenpairs; and</li>
<li><cite>ret</cite>, returned error code.</li>
</ul>
</li>
<li><p class="first">Before exiting, free the work arrays in PRIMME:</p>
<pre class="literal-block">
<a class="reference internal" href="#c.primme_Free" title="primme_Free"><code class="xref c c-func docutils literal"><span class="pre">primme_Free</span></code></a> (&amp;primme);
</pre>
</li>
</ol>
</div>
<div class="section" id="parameters-guide">
<span id="guide-params"></span><h3>Parameters Guide<a class="headerlink" href="#parameters-guide" title="Permalink to this headline">¶</a></h3>
<p>PRIMME stores the data on the structure <a class="reference internal" href="readme.html#c.primme_params" title="primme_params"><code class="xref c c-type docutils literal"><span class="pre">primme_params</span></code></a>, which has the next fields:</p>
<div class="line-block">
<div class="line"><em>Basic</em></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">n</span></code></a>,  matrix dimension.</div>
<div class="line"><code class="docutils literal"><span class="pre">void</span> <span class="pre">(*</span></code> <a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a> <code class="docutils literal"><span class="pre">)(...)</span></code>, matrix-vector product.</div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>, how many eigenpairs to find.</div>
<div class="line"><code class="docutils literal"><span class="pre">primme_target</span></code> <a class="reference internal" href="readme.html#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">target</span></code></a>, which eigenvalues to find.</div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.numTargetShifts" title="primme_params.numTargetShifts"><code class="xref c c-member docutils literal"><span class="pre">numTargetShifts</span></code></a>, for targeting interior eigenpairs.</div>
<div class="line"><code class="docutils literal"><span class="pre">double</span> <span class="pre">*</span></code> <a class="reference internal" href="readme.html#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">double</span></code> <a class="reference internal" href="readme.html#c.primme_params.eps" title="primme_params.eps"><code class="xref c c-member docutils literal"><span class="pre">eps</span></code></a>, tolerance of the residual norm of converged eigenpairs.</div>
<div class="line"><br /></div>
<div class="line"><em>For parallel programs</em></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.numProcs" title="primme_params.numProcs"><code class="xref c c-member docutils literal"><span class="pre">numProcs</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.procID" title="primme_params.procID"><code class="xref c c-member docutils literal"><span class="pre">procID</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.nLocal" title="primme_params.nLocal"><code class="xref c c-member docutils literal"><span class="pre">nLocal</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">void</span> <span class="pre">(*</span></code> <a class="reference internal" href="readme.html#c.primme_params.globalSumDouble" title="primme_params.globalSumDouble"><code class="xref c c-member docutils literal"><span class="pre">globalSumDouble</span></code></a> <code class="docutils literal"><span class="pre">)(...)</span></code></div>
<div class="line"><br /></div>
<div class="line"><em>Accelerate the convergence</em></div>
<div class="line"><code class="docutils literal"><span class="pre">void</span> <span class="pre">(*</span></code> <a class="reference internal" href="readme.html#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a> <code class="docutils literal"><span class="pre">)(...)</span></code>, preconditioner-vector product.</div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.initSize" title="primme_params.initSize"><code class="xref c c-member docutils literal"><span class="pre">initSize</span></code></a>, initial vectors as approximate solutions.</div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a></div>
<div class="line"><br /></div>
<div class="line"><em>User data</em></div>
<div class="line"><code class="docutils literal"><span class="pre">void</span> <span class="pre">*</span></code> <a class="reference internal" href="readme.html#c.primme_params.commInfo" title="primme_params.commInfo"><code class="xref c c-member docutils literal"><span class="pre">commInfo</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">void</span> <span class="pre">*</span></code> <a class="reference internal" href="readme.html#c.primme_params.matrix" title="primme_params.matrix"><code class="xref c c-member docutils literal"><span class="pre">matrix</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">void</span> <span class="pre">*</span></code> <a class="reference internal" href="readme.html#c.primme_params.preconditioner" title="primme_params.preconditioner"><code class="xref c c-member docutils literal"><span class="pre">preconditioner</span></code></a></div>
<div class="line"><br /></div>
<div class="line"><em>Advanced options</em></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.numOrthoConst" title="primme_params.numOrthoConst"><code class="xref c c-member docutils literal"><span class="pre">numOrthoConst</span></code></a>, orthogonal constrains to the eigenvectors.</div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.dynamicMethodSwitch" title="primme_params.dynamicMethodSwitch"><code class="xref c c-member docutils literal"><span class="pre">dynamicMethodSwitch</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.maxMatvecs" title="primme_params.maxMatvecs"><code class="xref c c-member docutils literal"><span class="pre">maxMatvecs</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.maxOuterIterations" title="primme_params.maxOuterIterations"><code class="xref c c-member docutils literal"><span class="pre">maxOuterIterations</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.intWorkSize" title="primme_params.intWorkSize"><code class="xref c c-member docutils literal"><span class="pre">intWorkSize</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">long</span> <span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.realWorkSize" title="primme_params.realWorkSize"><code class="xref c c-member docutils literal"><span class="pre">realWorkSize</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.iseed" title="primme_params.iseed"><code class="xref c c-member docutils literal"><span class="pre">iseed</span></code></a> <code class="docutils literal"><span class="pre">[4]</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span> <span class="pre">*</span></code> <a class="reference internal" href="readme.html#c.primme_params.intWork" title="primme_params.intWork"><code class="xref c c-member docutils literal"><span class="pre">intWork</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">void</span> <span class="pre">*</span></code> <a class="reference internal" href="readme.html#c.primme_params.realWork" title="primme_params.realWork"><code class="xref c c-member docutils literal"><span class="pre">realWork</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">double</span></code> <a class="reference internal" href="readme.html#c.primme_params.aNorm" title="primme_params.aNorm"><code class="xref c c-member docutils literal"><span class="pre">aNorm</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">int</span></code> <a class="reference internal" href="readme.html#c.primme_params.printLevel" title="primme_params.printLevel"><code class="xref c c-member docutils literal"><span class="pre">printLevel</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">FILE</span> <span class="pre">*</span></code> <a class="reference internal" href="readme.html#c.primme_params.outputFile" title="primme_params.outputFile"><code class="xref c c-member docutils literal"><span class="pre">outputFile</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">double</span> <span class="pre">*</span></code> <a class="reference internal" href="readme.html#c.primme_params.ShiftsForPreconditioner" title="primme_params.ShiftsForPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">ShiftsForPreconditioner</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">struct</span> <span class="pre">restarting_params</span></code> <a class="reference internal" href="readme.html#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">restartingParams</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">struct</span> <span class="pre">correction_params</span></code> <a class="reference internal" href="readme.html#c.primme_params.correctionParams.precondition" title="primme_params.correctionParams.precondition"><code class="xref c c-member docutils literal"><span class="pre">correctionParams</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">struct</span> <span class="pre">primme_stats</span></code> <a class="reference internal" href="readme.html#c.primme_params.stats.numOuterIterations" title="primme_params.stats.numOuterIterations"><code class="xref c c-member docutils literal"><span class="pre">stats</span></code></a></div>
<div class="line"><code class="docutils literal"><span class="pre">struct</span> <span class="pre">stackTraceNode</span> <span class="pre">*stackTrace</span></code></div>
</div>
<p>PRIMME requires the user to set at least the dimension of the matrix (<a class="reference internal" href="readme.html#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">n</span></code></a>) and
the matrix-vector product (<a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a>), as they define the problem to be solved.
For parallel programs, <a class="reference internal" href="readme.html#c.primme_params.nLocal" title="primme_params.nLocal"><code class="xref c c-member docutils literal"><span class="pre">nLocal</span></code></a>, <a class="reference internal" href="readme.html#c.primme_params.procID" title="primme_params.procID"><code class="xref c c-member docutils literal"><span class="pre">procID</span></code></a> and <a class="reference internal" href="readme.html#c.primme_params.globalSumDouble" title="primme_params.globalSumDouble"><code class="xref c c-member docutils literal"><span class="pre">globalSumDouble</span></code></a> are also required.</p>
<p>In addition, most users would want to specify how many eigenpairs to find,
and provide a preconditioner (if available).</p>
<p>It is useful to have set all these before calling <a class="reference internal" href="#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a>.
Also, if users have a preference on <a class="reference internal" href="readme.html#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a>, <a class="reference internal" href="readme.html#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a>, etc, they
should also provide them into <a class="reference internal" href="readme.html#c.primme_params" title="primme_params"><code class="xref c c-type docutils literal"><span class="pre">primme_params</span></code></a> prior to the
<a class="reference internal" href="#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> call. This helps <a class="reference internal" href="#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> make
the right choice on other parameters. It is sometimes useful to check the actual
parameters that PRIMME is going to use (before calling it) or used (on return)
by printing them with <a class="reference internal" href="#c.primme_display_params" title="primme_display_params"><code class="xref c c-func docutils literal"><span class="pre">primme_display_params()</span></code></a>.</p>
</div>
<div class="section" id="interface-description">
<h3>Interface Description<a class="headerlink" href="#interface-description" title="Permalink to this headline">¶</a></h3>
<p>The next enumerations and functions are declared in <code class="docutils literal"><span class="pre">primme.h</span></code>.</p>
<div class="section" id="dprimme">
<h4>dprimme<a class="headerlink" href="#dprimme" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="c.dprimme">
int <code class="descname">dprimme</code><span class="sig-paren">(</span>double<em>&nbsp;*evals</em>, double<em>&nbsp;*evecs</em>, double<em>&nbsp;*resNorms</em>, <a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.dprimme" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a real symmetric standard eigenproblem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>evals</strong> &#8211; array at least of size <a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> to store the
computed eigenvalues; all processes in a parallel run return this local array with the same values.</li>
<li><strong>resNorms</strong> &#8211; array at least of size <a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> to store the
residual norms of the computed eigenpairs; all processes in parallel run return this local array with
the same values.</li>
<li><strong>evecs</strong> &#8211; array at least of size <a class="reference internal" href="readme.html#c.primme_params.nLocal" title="primme_params.nLocal"><code class="xref c c-member docutils literal"><span class="pre">nLocal</span></code></a> times <a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>
to store columnwise the (local part of the) computed eigenvectors.</li>
<li><strong>primme</strong> &#8211; parameters structure.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">error indicator; see <a class="reference internal" href="readme.html#error-codes"><span>Error Codes</span></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="zprimme">
<h4>zprimme<a class="headerlink" href="#zprimme" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="c.zprimme">
int <code class="descname">zprimme</code><span class="sig-paren">(</span>double<em>&nbsp;*evals</em>, Complex_Z<em>&nbsp;*evecs</em>, double<em>&nbsp;*resNorms</em>, <a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.zprimme" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a Hermitian standard eigenproblem; see function <a class="reference internal" href="#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">PRIMME uses a structure called <code class="docutils literal"><span class="pre">Complex_Z</span></code> to define complex numbers.
<code class="docutils literal"><span class="pre">Complex_Z</span></code> is defined in <code class="file docutils literal"><span class="pre">PRIMMESRC/COMMONSRC/Complexz.h</span></code>.
In future versions of PRIMME, <code class="docutils literal"><span class="pre">Complex_Z</span></code> will be replaced by <code class="docutils literal"><span class="pre">complex</span> <span class="pre">double</span></code> from
the C99 standard.
Because the two types are binary compatible, we strongly recommend that calling
programs use the C99 type to maintain future compatibility.
See examples in <code class="file docutils literal"><span class="pre">TEST</span></code> such as <code class="file docutils literal"><span class="pre">ex_zseq.c</span></code> and <code class="file docutils literal"><span class="pre">ex_zseqf77.c</span></code>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="primme-initialize">
<h4>primme_initialize<a class="headerlink" href="#primme-initialize" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="c.primme_initialize">
void <code class="descname">primme_initialize</code><span class="sig-paren">(</span><a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.primme_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Set PRIMME parameters structure to the default values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> &#8211; parameters structure.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="primme-set-method">
<h4>primme_set_method<a class="headerlink" href="#primme-set-method" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="c.primme_set_method">
int <code class="descname">primme_set_method</code><span class="sig-paren">(</span><a class="reference internal" href="readme.html#c.primme_preset_method" title="primme_preset_method">primme_preset_method</a><em>&nbsp;method</em>, <a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.primme_set_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Set PRIMME parameters to one of the preset configurations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> &#8211; <p>preset configuration; one of</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.DYNAMIC" title="primme_preset_method.DYNAMIC"><code class="xref c c-member docutils literal"><span class="pre">DYNAMIC</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.DEFAULT_MIN_TIME" title="primme_preset_method.DEFAULT_MIN_TIME"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_TIME</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.DEFAULT_MIN_MATVECS" title="primme_preset_method.DEFAULT_MIN_MATVECS"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_MATVECS</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.Arnoldi" title="primme_preset_method.Arnoldi"><code class="xref c c-member docutils literal"><span class="pre">Arnoldi</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.GD" title="primme_preset_method.GD"><code class="xref c c-member docutils literal"><span class="pre">GD</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.GD_plusK" title="primme_preset_method.GD_plusK"><code class="xref c c-member docutils literal"><span class="pre">GD_plusK</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.GD_Olsen_plusK" title="primme_preset_method.GD_Olsen_plusK"><code class="xref c c-member docutils literal"><span class="pre">GD_Olsen_plusK</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.JD_Olsen_plusK" title="primme_preset_method.JD_Olsen_plusK"><code class="xref c c-member docutils literal"><span class="pre">JD_Olsen_plusK</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.RQI" title="primme_preset_method.RQI"><code class="xref c c-member docutils literal"><span class="pre">RQI</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.JDQR" title="primme_preset_method.JDQR"><code class="xref c c-member docutils literal"><span class="pre">JDQR</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.JDQMR" title="primme_preset_method.JDQMR"><code class="xref c c-member docutils literal"><span class="pre">JDQMR</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.JDQMR_ETol" title="primme_preset_method.JDQMR_ETol"><code class="xref c c-member docutils literal"><span class="pre">JDQMR_ETol</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.SUBSPACE_ITERATION" title="primme_preset_method.SUBSPACE_ITERATION"><code class="xref c c-member docutils literal"><span class="pre">SUBSPACE_ITERATION</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.LOBPCG_OrthoBasis" title="primme_preset_method.LOBPCG_OrthoBasis"><code class="xref c c-member docutils literal"><span class="pre">LOBPCG_OrthoBasis</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_preset_method.LOBPCG_OrthoBasis_Window" title="primme_preset_method.LOBPCG_OrthoBasis_Window"><code class="xref c c-member docutils literal"><span class="pre">LOBPCG_OrthoBasis_Window</span></code></a></div>
</div>
</li>
<li><strong>primme</strong> &#8211; parameters structure.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See also <a class="reference internal" href="readme.html#methods"><span>Preset Methods</span></a>.</p>
</dd></dl>

</div>
<div class="section" id="primme-display-params">
<h4>primme_display_params<a class="headerlink" href="#primme-display-params" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="c.primme_display_params">
void <code class="descname">primme_display_params</code><span class="sig-paren">(</span><a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.primme_display_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Display all printable settings of <code class="docutils literal"><span class="pre">primme</span></code> into the file descriptor <a class="reference internal" href="readme.html#c.primme_params.outputFile" title="primme_params.outputFile"><code class="xref c c-member docutils literal"><span class="pre">outputFile</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> &#8211; parameters structure.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="primme-free">
<h4>primme_Free<a class="headerlink" href="#primme-free" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="c.primme_Free">
void <code class="descname">primme_Free</code><span class="sig-paren">(</span><a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.primme_Free" title="Permalink to this definition">¶</a></dt>
<dd><p>Free memory allocated by PRIMME.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> &#8211; parameters structure.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>
<span id="document-primmef77"></span><div class="section" id="fortran-library-interface">
<h2>FORTRAN Library Interface<a class="headerlink" href="#fortran-library-interface" title="Permalink to this headline">¶</a></h2>
<p>The next enumerations and functions are declared in <code class="docutils literal"><span class="pre">primme_f77.h</span></code>.</p>
<dl class="type">
<dt id="c.ptr">
<code class="descname">ptr</code><a class="headerlink" href="#c.ptr" title="Permalink to this definition">¶</a></dt>
<dd><p>Fortran datatype with the same size as a pointer.
Use <code class="docutils literal"><span class="pre">integer*4</span></code> when compiling in 32 bits and <code class="docutils literal"><span class="pre">integer*8</span></code> in 64 bits.</p>
</dd></dl>

<div class="section" id="primme-initialize-f77">
<h3>primme_initialize_f77<a class="headerlink" href="#primme-initialize-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primme_initialize_f77">
<code class="descname">primme_initialize_f77</code><span class="sig-paren">(</span>primme<span class="sig-paren">)</span><a class="headerlink" href="#c.primme_initialize_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Set PRIMME parameters structure to the default values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (output) parameters structure.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="primme-set-method-f77">
<h3>primme_set_method_f77<a class="headerlink" href="#primme-set-method-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primme_set_method_f77">
<code class="descname">primme_set_method_f77</code><span class="sig-paren">(</span>method, primme, ierr<span class="sig-paren">)</span><a class="headerlink" href="#c.primme_set_method_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Set PRIMME parameters to one of the preset configurations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method</strong> (<em>integer</em>) &#8211; <p>(input) preset configuration. One of:</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_DYNAMIC</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_DEFAULT_MIN_TIME</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_DEFAULT_MIN_MATVECS</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_Arnoldi</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_GD</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_GD_plusK</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_GD_Olsen_plusK</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_JD_Olsen_plusK</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_RQI</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_JDQR</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_JDQMR</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_JDQMR_ETol</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_SUBSPACE_ITERATION</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_LOBPCG_OrthoBasis</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">PRIMMEF77_LOBPCG_OrthoBasis_Window</span></code></div>
</div>
<p>See <a class="reference internal" href="readme.html#c.primme_preset_method" title="primme_preset_method"><code class="xref c c-type docutils literal"><span class="pre">primme_preset_method</span></code></a>.</p>
</li>
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (input) parameters structure.</li>
<li><strong>ierr</strong> (<em>integer</em>) &#8211; (output) if 0, successful; if negative, something went wrong.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="primme-free-f77">
<h3>primme_Free_f77<a class="headerlink" href="#primme-free-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primme_Free_f77">
<code class="descname">primme_Free_f77</code><span class="sig-paren">(</span>primme<span class="sig-paren">)</span><a class="headerlink" href="#c.primme_Free_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Free memory allocated by PRIMME.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; parameters structure.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="dprimme-f77">
<h3>dprimme_f77<a class="headerlink" href="#dprimme-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.dprimme_f77">
<code class="descname">dprimme_f77</code><span class="sig-paren">(</span>evals, evecs, resNorms, primme, ierr<span class="sig-paren">)</span><a class="headerlink" href="#c.dprimme_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a real symmetric standard eigenproblem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>evals(*)</strong> (<em>double precision</em>) &#8211; (output) array at least of size <a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> to store the
computed eigenvalues; all parallel calls return the same value in this array.</li>
<li><strong>resNorms(*)</strong> (<em>double precision</em>) &#8211; (output) array at least of size <a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> to store the
residual norms of the computed eigenpairs; all parallel calls return the same value in this array.</li>
<li><strong>evecs(*)</strong> (<em>double precision</em>) &#8211; (input/output) array at least of size <a class="reference internal" href="readme.html#c.primme_params.nLocal" title="primme_params.nLocal"><code class="xref c c-member docutils literal"><span class="pre">nLocal</span></code></a> times <a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>
to store columnwise the (local part of the) computed eigenvectors.</li>
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; parameters structure.</li>
<li><strong>ierr</strong> (<em>integer</em>) &#8211; (output) error indicator; see <a class="reference internal" href="readme.html#error-codes"><span>Error Codes</span></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="zprimme-f77">
<h3>zprimme_f77<a class="headerlink" href="#zprimme-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.zprimme_f77">
<code class="descname">zprimme_f77</code><span class="sig-paren">(</span>evals, evecs, resNorms, primme, ierr<span class="sig-paren">)</span><a class="headerlink" href="#c.zprimme_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a Hermitian standard eigenproblem. The arguments have the
same meaning as in function <a class="reference internal" href="#c.dprimme_f77" title="dprimme_f77"><code class="xref c c-func docutils literal"><span class="pre">dprimme_f77()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>evals(*)</strong> (<em>double precision</em>) &#8211; (output)</li>
<li><strong>resNorms(*)</strong> (<em>double precision</em>) &#8211; (output)</li>
<li><strong>evecs(*)</strong> (<em>complex double precision</em>) &#8211; (input/output)</li>
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (input) parameters structure.</li>
<li><strong>ierr</strong> (<em>integer</em>) &#8211; (output) error indicator; see <a class="reference internal" href="readme.html#error-codes"><span>Error Codes</span></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="primmetop-set-member-f77">
<h3>primmetop_set_member_f77<a class="headerlink" href="#primmetop-set-member-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primmetop_set_member_f77">
<code class="descname">primmetop_set_member_f77</code><span class="sig-paren">(</span>primme, label, value<span class="sig-paren">)</span><a class="headerlink" href="#c.primmetop_set_member_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a value in some field of the parameter structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (input) parameters structure.</li>
<li><strong>label</strong> (<em>integer</em>) &#8211; <p>field where to set value. One of:</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_n</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_matrixMatvec</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_applyPreconditioner</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.numProcs" title="primme_params.numProcs"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_numProcs</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.procID" title="primme_params.procID"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_procID</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.commInfo" title="primme_params.commInfo"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_commInfo</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.nLocal" title="primme_params.nLocal"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_nLocal</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.globalSumDouble" title="primme_params.globalSumDouble"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_globalSumDouble</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_numEvals</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_target</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.numTargetShifts" title="primme_params.numTargetShifts"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_numTargetShifts</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_targetShifts</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_locking</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.initSize" title="primme_params.initSize"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_initSize</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.numOrthoConst" title="primme_params.numOrthoConst"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_numOrthoConst</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_maxBasisSize</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_minRestartSize</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_maxBlockSize</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.maxMatvecs" title="primme_params.maxMatvecs"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_maxMatvecs</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.maxOuterIterations" title="primme_params.maxOuterIterations"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_maxOuterIterations</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.intWorkSize" title="primme_params.intWorkSize"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_intWorkSize</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.realWorkSize" title="primme_params.realWorkSize"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_realWorkSize</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.iseed" title="primme_params.iseed"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_iseed</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.intWork" title="primme_params.intWork"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_intWork</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.realWork" title="primme_params.realWork"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_realWork</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.aNorm" title="primme_params.aNorm"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_aNorm</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.eps" title="primme_params.eps"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_eps</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.printLevel" title="primme_params.printLevel"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_printLevel</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.outputFile" title="primme_params.outputFile"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_outputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.matrix" title="primme_params.matrix"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_matrix</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.preconditioner" title="primme_params.preconditioner"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_preconditioner</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_restartingParams_scheme</span></code></a>.</div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_restartingParams_maxPrevRetain</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.precondition" title="primme_params.correctionParams.precondition"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_precondition</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.robustShifts" title="primme_params.correctionParams.robustShifts"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_robustShifts</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_maxInnerIterations</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.projectors.LeftQ" title="primme_params.correctionParams.projectors.LeftQ"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_projectors_LeftQ</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.projectors.LeftX" title="primme_params.correctionParams.projectors.LeftX"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_projectors_LeftX</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.projectors.RightQ" title="primme_params.correctionParams.projectors.RightQ"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_projectors_RightQ</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_projectors_RightX</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.projectors.SkewQ" title="primme_params.correctionParams.projectors.SkewQ"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_projectors_SkewQ</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_projectors_SkewX</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_convTest</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.correctionParams.relTolBase" title="primme_params.correctionParams.relTolBase"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_correctionParams_relTolBase</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.stats.numOuterIterations" title="primme_params.stats.numOuterIterations"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_stats_numOuterIterations</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.stats.numRestarts" title="primme_params.stats.numRestarts"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_stats_numRestarts</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.stats.numMatvecs" title="primme_params.stats.numMatvecs"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_stats_numMatvecs</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.stats.numPreconds" title="primme_params.stats.numPreconds"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_stats_numPreconds</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.stats.elapsedTime" title="primme_params.stats.elapsedTime"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_stats_elapsedTime</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.dynamicMethodSwitch" title="primme_params.dynamicMethodSwitch"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_dynamicMethodSwitch</span></code></a></div>
<div class="line"><a class="reference internal" href="readme.html#c.primme_params.massMatrixMatvec" title="primme_params.massMatrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">PRIMMEF77_massMatrixMatvec</span></code></a></div>
</div>
</li>
<li><strong>value</strong> &#8211; (input) value to set.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Don&#8217;t use</strong> this function inside PRIMME&#8217;s callback functions, e.g., <a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a> or
<a class="reference internal" href="readme.html#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a>, or in functions called by these functions. In those cases use
<a class="reference internal" href="#c.primme_set_member_f77" title="primme_set_member_f77"><code class="xref c c-func docutils literal"><span class="pre">primme_set_member_f77()</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="primmetop-get-member-f77">
<h3>primmetop_get_member_f77<a class="headerlink" href="#primmetop-get-member-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primmetop_get_member_f77">
<code class="descname">primmetop_get_member_f77</code><span class="sig-paren">(</span>primme, label, value<span class="sig-paren">)</span><a class="headerlink" href="#c.primmetop_get_member_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value in some field of the parameter structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (input) parameters structure.</li>
<li><strong>label</strong> (<em>integer</em>) &#8211; (input) field where to get value. One of
the detailed in function <a class="reference internal" href="#c.primmetop_set_member_f77" title="primmetop_set_member_f77"><code class="xref c c-func docutils literal"><span class="pre">primmetop_set_member_f77()</span></code></a>.</li>
<li><strong>value</strong> &#8211; (output) value of the field.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Don&#8217;t use</strong> this function inside PRIMME&#8217;s callback functions, e.g., <a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a> or
<a class="reference internal" href="readme.html#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a>, or in functions called by these functions. In those cases use
<a class="reference internal" href="#c.primme_get_member_f77" title="primme_get_member_f77"><code class="xref c c-func docutils literal"><span class="pre">primme_get_member_f77()</span></code></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When <code class="docutils literal"><span class="pre">label</span></code> is one of <code class="docutils literal"><span class="pre">PRIMMEF77_matrixMatvec</span></code>, <code class="docutils literal"><span class="pre">PRIMMEF77_applyPreconditioner</span></code>, <code class="docutils literal"><span class="pre">PRIMMEF77_commInfo</span></code>,
<code class="docutils literal"><span class="pre">PRIMMEF77_intWork</span></code>, <code class="docutils literal"><span class="pre">PRIMMEF77_realWork</span></code>, <code class="docutils literal"><span class="pre">PRIMMEF77_matrix</span></code> and <code class="docutils literal"><span class="pre">PRIMMEF77_preconditioner</span></code>,
the returned <code class="docutils literal"><span class="pre">value</span></code> is a C pointer (<code class="docutils literal"><span class="pre">void*</span></code>). Use Fortran pointer or other extensions to deal with it.
For instance:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">use</span> <span class="n">iso_c_binding</span>
<span class="n">MPI_Comm</span> <span class="n">comm</span>

<span class="n">comm</span> <span class="o">=</span> <span class="n">MPI_COMM_WORLD</span>
<span class="n">call</span> <span class="n">primme_set_member_f77</span><span class="p">(</span><span class="n">primme</span><span class="p">,</span> <span class="n">PRIMMEF77_commInfo</span><span class="p">,</span> <span class="n">comm</span><span class="p">)</span>
<span class="p">...</span>
<span class="n">subroutine</span> <span class="n">par_GlobalSumDouble</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">primme</span><span class="p">)</span>
<span class="n">use</span> <span class="n">iso_c_binding</span>
<span class="n">implicit</span> <span class="n">none</span>
<span class="p">...</span>
<span class="n">MPI_Comm</span><span class="p">,</span> <span class="n">pointer</span> <span class="o">::</span> <span class="n">comm</span>
<span class="n">type</span><span class="p">(</span><span class="n">c_ptr</span><span class="p">)</span> <span class="o">::</span> <span class="n">pcomm</span>

<span class="n">call</span> <span class="n">primme_get_member_f77</span><span class="p">(</span><span class="n">primme</span><span class="p">,</span> <span class="n">PRIMMEF77_commInfo</span><span class="p">,</span> <span class="n">pcomm</span><span class="p">)</span>
<span class="n">call</span> <span class="n">c_f_pointer</span><span class="p">(</span><span class="n">pcomm</span><span class="p">,</span> <span class="n">comm</span><span class="p">)</span>
<span class="n">call</span> <span class="n">MPI_Allreduce</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="n">MPI_SUM</span><span class="p">,</span><span class="n">comm</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">Most users would not need to retrieve these pointers in their programs.</p>
</div>
</dd></dl>

</div>
<div class="section" id="primmetop-get-prec-shift-f77">
<h3>primmetop_get_prec_shift_f77<a class="headerlink" href="#primmetop-get-prec-shift-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primmetop_get_prec_shift_f77">
<code class="descname">primmetop_get_prec_shift_f77</code><span class="sig-paren">(</span>primme, index, value<span class="sig-paren">)</span><a class="headerlink" href="#c.primmetop_get_prec_shift_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value in some position of the array <a class="reference internal" href="readme.html#c.primme_params.ShiftsForPreconditioner" title="primme_params.ShiftsForPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">ShiftsForPreconditioner</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (input) parameters structure.</li>
<li><strong>index</strong> (<em>integer</em>) &#8211; (input) position of the array; the first position is 1.</li>
<li><strong>value</strong> &#8211; (output) value of the array at that position.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="primme-set-member-f77">
<h3>primme_set_member_f77<a class="headerlink" href="#primme-set-member-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primme_set_member_f77">
<code class="descname">primme_set_member_f77</code><span class="sig-paren">(</span>primme, label, value<span class="sig-paren">)</span><a class="headerlink" href="#c.primme_set_member_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a value in some field of the parameter structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (input) parameters structure.</li>
<li><strong>label</strong> (<em>integer</em>) &#8211; field where to set value. One of the vales defined
in <a class="reference internal" href="#c.primmetop_set_member_f77" title="primmetop_set_member_f77"><code class="xref c c-func docutils literal"><span class="pre">primmetop_set_member_f77()</span></code></a>.</li>
<li><strong>value</strong> &#8211; (input) value to set.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use this function exclusively inside PRIMME&#8217;s callback functions, e.g., <a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a>
or <a class="reference internal" href="readme.html#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a>, or in functions called by these functions. Otherwise, e.g.,
from the main program, use the function <a class="reference internal" href="#c.primmetop_set_member_f77" title="primmetop_set_member_f77"><code class="xref c c-func docutils literal"><span class="pre">primmetop_set_member_f77()</span></code></a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="primme-get-member-f77">
<h3>primme_get_member_f77<a class="headerlink" href="#primme-get-member-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primme_get_member_f77">
<code class="descname">primme_get_member_f77</code><span class="sig-paren">(</span>primme, label, value<span class="sig-paren">)</span><a class="headerlink" href="#c.primme_get_member_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value in some field of the parameter structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (input) parameters structure.</li>
<li><strong>label</strong> (<em>integer</em>) &#8211; (input) field where to get value. One of
the detailed in function <a class="reference internal" href="#c.primmetop_set_member_f77" title="primmetop_set_member_f77"><code class="xref c c-func docutils literal"><span class="pre">primmetop_set_member_f77()</span></code></a>.</li>
<li><strong>value</strong> &#8211; (output) value of the field.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use this function exclusively inside PRIMME&#8217;s callback functions, e.g., <a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a>
or <a class="reference internal" href="readme.html#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a>, or in functions called by these functions. Otherwise, e.g.,
from the main program, use the function <a class="reference internal" href="#c.primmetop_get_member_f77" title="primmetop_get_member_f77"><code class="xref c c-func docutils literal"><span class="pre">primmetop_get_member_f77()</span></code></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When <code class="docutils literal"><span class="pre">label</span></code> is one of <code class="docutils literal"><span class="pre">PRIMMEF77_matrixMatvec</span></code>, <code class="docutils literal"><span class="pre">PRIMMEF77_applyPreconditioner</span></code>, <code class="docutils literal"><span class="pre">PRIMMEF77_commInfo</span></code>,
<code class="docutils literal"><span class="pre">PRIMMEF77_intWork</span></code>, <code class="docutils literal"><span class="pre">PRIMMEF77_realWork</span></code>, <code class="docutils literal"><span class="pre">PRIMMEF77_matrix</span></code> and <code class="docutils literal"><span class="pre">PRIMMEF77_preconditioner</span></code>,
the returned <code class="docutils literal"><span class="pre">value</span></code> is a C pointer (<code class="docutils literal"><span class="pre">void*</span></code>). Use Fortran pointer or other extensions to deal with it.
For instance:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">use</span> <span class="n">iso_c_binding</span>
<span class="n">MPI_Comm</span> <span class="n">comm</span>

<span class="n">comm</span> <span class="o">=</span> <span class="n">MPI_COMM_WORLD</span>
<span class="n">call</span> <span class="n">primme_set_member_f77</span><span class="p">(</span><span class="n">primme</span><span class="p">,</span> <span class="n">PRIMMEF77_commInfo</span><span class="p">,</span> <span class="n">comm</span><span class="p">)</span>
<span class="p">...</span>
<span class="n">subroutine</span> <span class="n">par_GlobalSumDouble</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">primme</span><span class="p">)</span>
<span class="n">use</span> <span class="n">iso_c_binding</span>
<span class="n">implicit</span> <span class="n">none</span>
<span class="p">...</span>
<span class="n">MPI_Comm</span><span class="p">,</span> <span class="n">pointer</span> <span class="o">::</span> <span class="n">comm</span>
<span class="n">type</span><span class="p">(</span><span class="n">c_ptr</span><span class="p">)</span> <span class="o">::</span> <span class="n">pcomm</span>

<span class="n">call</span> <span class="n">primme_get_member_f77</span><span class="p">(</span><span class="n">primme</span><span class="p">,</span> <span class="n">PRIMMEF77_commInfo</span><span class="p">,</span> <span class="n">pcomm</span><span class="p">)</span>
<span class="n">call</span> <span class="n">c_f_pointer</span><span class="p">(</span><span class="n">pcomm</span><span class="p">,</span> <span class="n">comm</span><span class="p">)</span>
<span class="n">call</span> <span class="n">MPI_Allreduce</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="n">MPI_SUM</span><span class="p">,</span><span class="n">comm</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">Most users would not need to retrieve these pointers in their programs.</p>
</div>
</dd></dl>

</div>
<div class="section" id="primme-get-prec-shift-f77">
<h3>primme_get_prec_shift_f77<a class="headerlink" href="#primme-get-prec-shift-f77" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="c.primme_get_prec_shift_f77">
<code class="descname">primme_get_prec_shift_f77</code><span class="sig-paren">(</span>primme, index, value<span class="sig-paren">)</span><a class="headerlink" href="#c.primme_get_prec_shift_f77" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value in some position of the array <a class="reference internal" href="readme.html#c.primme_params.ShiftsForPreconditioner" title="primme_params.ShiftsForPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">ShiftsForPreconditioner</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>primme</strong> (<a class="reference internal" href="readme.html#c.ptr" title="ptr"><em>ptr</em></a>) &#8211; (input) parameters structure.</li>
<li><strong>index</strong> (<em>integer</em>) &#8211; (input) position of the array; the first position is 1.</li>
<li><strong>value</strong> &#8211; (output) value of the array at that position.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use this function exclusively inside the function <a class="reference internal" href="readme.html#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a>, <a class="reference internal" href="readme.html#c.primme_params.massMatrixMatvec" title="primme_params.massMatrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">massMatrixMatvec</span></code></a>, or <a class="reference internal" href="readme.html#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a>.
Otherwise use the function <a class="reference internal" href="#c.primmetop_get_prec_shift_f77" title="primmetop_get_prec_shift_f77"><code class="xref c c-func docutils literal"><span class="pre">primmetop_get_prec_shift_f77()</span></code></a>.</p>
</div>
</dd></dl>

</div>
</div>
<span id="document-appendix"></span><div class="section" id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h2>
<div class="section" id="primme-params">
<h3>primme_params<a class="headerlink" href="#primme-params" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="c.primme_params">
<code class="descname">primme_params</code><a class="headerlink" href="#c.primme_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure to set the problem matrices and eigensolver options.</p>
<dl class="member">
<dt id="c.primme_params.n">
int <code class="descname">n</code><a class="headerlink" href="#c.primme_params.n" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of the matrix.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.matrixMatvec">
void <code class="descname">(*matrixMatvec)</code><span class="sig-paren">(</span>void<em>&nbsp;*x</em>, void<em>&nbsp;*y</em>, int<em>&nbsp;*blockSize</em>, <a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.primme_params.matrixMatvec" title="Permalink to this definition">¶</a></dt>
<dd><p>Block matrix-multivector multiplication, <span class="math">\(y = A x\)</span> in solving <span class="math">\(A x = \lambda x\)</span> or <span class="math">\(A x = \lambda B x\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; one dimensional array containing the <code class="docutils literal"><span class="pre">blockSize</span></code> vectors
packed one after the other (i.e., the leading dimension is the vector size), each of size <a class="reference internal" href="#c.primme_params.nLocal" title="primme_params.nLocal"><code class="xref c c-member docutils literal"><span class="pre">nLocal</span></code></a>.
The real type is <code class="docutils literal"><span class="pre">double*</span></code> and <code class="docutils literal"><span class="pre">Complex_Z*</span></code> when called from <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> and <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> respectively.</li>
<li><strong>y</strong> &#8211; one dimensional array containing the <code class="docutils literal"><span class="pre">blockSize</span></code> vectors
packed one after the other (i.e., the leading dimension is the vector size), each of size <a class="reference internal" href="#c.primme_params.nLocal" title="primme_params.nLocal"><code class="xref c c-member docutils literal"><span class="pre">nLocal</span></code></a>.
The real type is <code class="docutils literal"><span class="pre">double*</span></code> and <code class="docutils literal"><span class="pre">Complex_Z*</span></code> when called from <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> and <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> respectively.</li>
<li><strong>blockSize</strong> &#8211; number of vectors in x and y.</li>
<li><strong>primme</strong> &#8211; parameters structure.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Argument <code class="docutils literal"><span class="pre">blockSize</span></code> is passed by reference to make easier the interface to other
languages (like Fortran).</p>
</div>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.applyPreconditioner">
void <code class="descname">(*applyPreconditioner)</code><span class="sig-paren">(</span>void<em>&nbsp;*x</em>, void<em>&nbsp;*y</em>, int<em>&nbsp;*blockSize</em>, struct <a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.primme_params.applyPreconditioner" title="Permalink to this definition">¶</a></dt>
<dd><p>Block preconditioner-multivector application, <span class="math">\(y = M^{-1}x\)</span> where <span class="math">\(M\)</span> is usually an approximation of <span class="math">\(A - \sigma I\)</span> or <span class="math">\(A - \sigma B\)</span> for finding eigenvalues close to <span class="math">\(\sigma\)</span>.
The function follows the convention of <a class="reference internal" href="#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.massMatrixMatvec">
void <code class="descname">(*massMatrixMatvec)</code><span class="sig-paren">(</span>void<em>&nbsp;*x</em>, void<em>&nbsp;*y</em>, int<em>&nbsp;*blockSize</em>, struct <a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.primme_params.massMatrixMatvec" title="Permalink to this definition">¶</a></dt>
<dd><p>Block matrix-multivector multiplication, <span class="math">\(y = B x\)</span> in solving <span class="math">\(A x = \lambda B x\)</span>.
The function follows the convention of <a class="reference internal" href="#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Generalized eigenproblems not implemented in current version.
This member is included for future compatibility.</p>
</div>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.numProcs">
int <code class="descname">numProcs</code><a class="headerlink" href="#c.primme_params.numProcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of processes calling <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> or <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> in parallel.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 1;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.procID">
int <code class="descname">procID</code><a class="headerlink" href="#c.primme_params.procID" title="Permalink to this definition">¶</a></dt>
<dd><p>The identity of the local process within a parallel execution calling <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> or
<a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a>.
Only the process with id 0 prints information.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line"><a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> sets this field to 0 if <a class="reference internal" href="#c.primme_params.numProcs" title="primme_params.numProcs"><code class="xref c c-member docutils literal"><span class="pre">numProcs</span></code></a> is 1;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.nLocal">
int <code class="descname">nLocal</code><a class="headerlink" href="#c.primme_params.nLocal" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of local rows on this process.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line"><a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> sets this field to to <a class="reference internal" href="#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">n</span></code></a> if <a class="reference internal" href="#c.primme_params.numProcs" title="primme_params.numProcs"><code class="xref c c-member docutils literal"><span class="pre">numProcs</span></code></a> is 1;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.commInfo">
void *<code class="descname">commInfo</code><a class="headerlink" href="#c.primme_params.commInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>A pointer to whatever parallel environment structures needed.
For example, with MPI, it could be a pointer to the MPI communicator.
PRIMME does not use this. It is available for possible use in
user functions defined in <a class="reference internal" href="#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a>,
<a class="reference internal" href="#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a>, <a class="reference internal" href="#c.primme_params.massMatrixMatvec" title="primme_params.massMatrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">massMatrixMatvec</span></code></a> and
<a class="reference internal" href="#c.primme_params.globalSumDouble" title="primme_params.globalSumDouble"><code class="xref c c-member docutils literal"><span class="pre">globalSumDouble</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.globalSumDouble">
void <code class="descname">(*globalSumDouble)</code><span class="sig-paren">(</span>double<em>&nbsp;*sendBuf</em>, double<em>&nbsp;*recvBuf</em>, int<em>&nbsp;*count</em>, <a class="reference internal" href="readme.html#c.primme_params" title="primme_params">primme_params</a><em>&nbsp;*primme</em><span class="sig-paren">)</span><a class="headerlink" href="#c.primme_params.globalSumDouble" title="Permalink to this definition">¶</a></dt>
<dd><p>Global sum reduction function. No need to set for sequential programs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sendBuf</strong> &#8211; array of size <code class="docutils literal"><span class="pre">count</span></code> with the local input values.</li>
<li><strong>recvBuf</strong> &#8211; array of size <code class="docutils literal"><span class="pre">count</span></code> with the global output values
so that the i-th element of recvBuf is the sum over all processes of the i-th element
of <code class="docutils literal"><span class="pre">sendBuf</span></code>.</li>
<li><strong>count</strong> &#8211; array size of <code class="docutils literal"><span class="pre">sendBuf</span></code> and <code class="docutils literal"><span class="pre">recvBuf</span></code>.</li>
<li><strong>primme</strong> &#8211; parameters structure.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to an internal function;</div>
<div class="line"><a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> sets this field to an internal function if <a class="reference internal" href="#c.primme_params.numProcs" title="primme_params.numProcs"><code class="xref c c-member docutils literal"><span class="pre">numProcs</span></code></a> is 1 and <a class="reference internal" href="#c.primme_params.globalSumDouble" title="primme_params.globalSumDouble"><code class="xref c c-member docutils literal"><span class="pre">globalSumDouble</span></code></a> is NULL;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<p>When MPI is used this can be a simply wrapper to MPI_Allreduce().</p>
<div class="code c highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">par_GlobalSumDouble</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">sendBuf</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">recvBuf</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">count</span><span class="p">,</span>
                         <span class="n">primme_params</span> <span class="o">*</span><span class="n">primme</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">MPI_Comm</span> <span class="n">communicator</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">MPI_Comm</span> <span class="o">*</span><span class="p">)</span> <span class="n">primme</span><span class="o">-&gt;</span><span class="n">commInfo</span><span class="p">;</span>
   <span class="n">MPI_Allreduce</span><span class="p">(</span><span class="n">sendBuf</span><span class="p">,</span> <span class="n">recvBuf</span><span class="p">,</span> <span class="o">*</span><span class="n">count</span><span class="p">,</span> <span class="n">MPI_DOUBLE</span><span class="p">,</span> <span class="n">MPI_SUM</span><span class="p">,</span>
                 <span class="n">communicator</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Argument <code class="docutils literal"><span class="pre">count</span></code> is passed by reference to make easier the interface to other
languages (like Fortran).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The arguments <code class="docutils literal"><span class="pre">sendBuf</span></code> and <code class="docutils literal"><span class="pre">recvBuf</span></code> are always double arrays and <code class="docutils literal"><span class="pre">count</span></code>
is always the number of double elements in both arrays, even for <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.numEvals">
int <code class="descname">numEvals</code><a class="headerlink" href="#c.primme_params.numEvals" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of eigenvalues wanted.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 1;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>) and <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<span class="target" id="index-0"></span><dl class="member">
<dt id="c.primme_params.target">
primme_target <code class="descname">target</code><a class="headerlink" href="#c.primme_params.target" title="Permalink to this definition">¶</a></dt>
<dd><p>Which eigenpairs to find:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">primme_smallest</span></code></dt>
<dd>Smallest algebraic eigenvalues; <a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a> is ignored.</dd>
<dt><code class="docutils literal"><span class="pre">primme_largest</span></code></dt>
<dd>Largest algebraic eigenvalues; <a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a> is ignored.</dd>
<dt><code class="docutils literal"><span class="pre">primme_closest_geq</span></code></dt>
<dd>Closest to, but greater or equal than the shifts in <a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a>.</dd>
<dt><code class="docutils literal"><span class="pre">primme_closest_leq</span></code></dt>
<dd>Closest to, but less or equal than the shifts in <a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a>.</dd>
<dt><code class="docutils literal"><span class="pre">primme_closest_abs</span></code></dt>
<dd>Closest in absolute value to than the shifts in <a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a>.</dd>
</dl>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_smallest</span></code></a>;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<span class="target" id="index-1"></span><dl class="member">
<dt id="c.primme_params.numTargetShifts">
int <code class="descname">numTargetShifts</code><a class="headerlink" href="#c.primme_params.numTargetShifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the array <a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a>.
Used only when <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">target</span></code></a> is <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_geq</span></code></a>,
<a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_leq</span></code></a> or <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_abs</span></code></a>.
The default values is 0.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<span class="target" id="index-2"></span><dl class="member">
<dt id="c.primme_params.targetShifts">
double *<code class="descname">targetShifts</code><a class="headerlink" href="#c.primme_params.targetShifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of shifts, at least of size <a class="reference internal" href="#c.primme_params.numTargetShifts" title="primme_params.numTargetShifts"><code class="xref c c-member docutils literal"><span class="pre">numTargetShifts</span></code></a>.
Used only when <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">target</span></code></a> is <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_geq</span></code></a>,
<a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_leq</span></code></a> or <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_abs</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<p>The i-th shift (or the last one, if it is not given) is taken into account in
finding the i-th eigenvalue.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Considerations for interior problems:</p>
<ul class="last simple">
<li>PRIMME will try to compute the eigenvalues in the order given in the
<a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a>. However, for code efficiency and robustness, the shifts
should be ordered. Order them in ascending (descending) order for shifts
closer to the lower (higher) end of the spectrum.</li>
<li>If some shift is close to the lower (higher) end of the spectrum,
use either <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_geq</span></code></a> (<a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_leq</span></code></a>) or
<a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_abs</span></code></a>.</li>
<li><a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_leq</span></code></a> and <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_geq</span></code></a> are more efficient
than <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_abs</span></code></a>.</li>
<li>For interior eigenvalues larger <a class="reference internal" href="#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a> is usually more robust.</li>
</ul>
</div>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.printLevel">
int <code class="descname">printLevel</code><a class="headerlink" href="#c.primme_params.printLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>The level of message reporting from the code.
One of:</p>
<ul>
<li><p class="first">0: silent.</p>
</li>
<li><p class="first">1: print some error messages when these occur.</p>
</li>
<li><p class="first">2: as 1, and info about targeted eigenpairs when they are marked as converged:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#Converged $1 eval[ $2 ]= $3 norm $4 Mvecs $5 Time $7</span>
</pre></div>
</div>
<p>or locked:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#Lock epair[ $1 ]= $3 norm $4 Mvecs $5 Time $7</span>
</pre></div>
</div>
</li>
<li><p class="first">3: as 2, and info about targeted eigenpairs every outer iteration:</p>
<div class="highlight-c"><div class="highlight"><pre>OUT $6 conv $1 blk $8 MV $5 Sec $7 EV $3 |r| $4
</pre></div>
</div>
<p>Also, if it is used the dynamic method, show JDQMR/GDk performance ratio and
the current method in use.</p>
</li>
<li><p class="first">4: as 3, and info about targeted eigenpairs every inner iteration:</p>
<div class="highlight-c"><div class="highlight"><pre>INN MV $5 Sec $7 Eval $3 Lin|r| $9 EV|r| $4
</pre></div>
</div>
</li>
<li><p class="first">5: as 4, and verbose info about certain choices of the algorithm.</p>
</li>
</ul>
<p>Output key:</p>
<div class="line-block">
<div class="line">$1: Number of converged pairs up to now.</div>
<div class="line">$2: The index of the pair currently converged.</div>
<div class="line">$3: The eigenvalue.</div>
<div class="line">$4: Its residual norm.</div>
<div class="line">$5: The current number of matrix-vector products.</div>
<div class="line">$6: The current number of outer iterations.</div>
<div class="line">$7: The current elapsed time.</div>
<div class="line">$8: Index within the block of the targeted pair .</div>
<div class="line">$9: QMR norm of the linear system residual.</div>
</div>
<p>In parallel programs, output is produced in call with
<a class="reference internal" href="#c.primme_params.procID" title="primme_params.procID"><code class="xref c c-member docutils literal"><span class="pre">procID</span></code></a> 0 when <a class="reference internal" href="#c.primme_params.printLevel" title="primme_params.printLevel"><code class="xref c c-member docutils literal"><span class="pre">printLevel</span></code></a>
is from 0 to 4.
If <a class="reference internal" href="#c.primme_params.printLevel" title="primme_params.printLevel"><code class="xref c c-member docutils literal"><span class="pre">printLevel</span></code></a> is 5 output can be produced in any of
the parallel calls.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 1;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Convergence history for plotting may be produced simply by:</p>
<div class="highlight-c"><div class="highlight"><pre>grep OUT outpufile | awk &#39;{print $8&quot; &quot;$14}&#39; &gt; out
grep INN outpufile | awk &#39;{print $3&quot; &quot;$11}&#39; &gt; inn
</pre></div>
</div>
<p>Then in Matlab:</p>
<div class="highlight-c"><div class="highlight"><pre>plot(out(:,1),out(:,2),&#39;bo&#39;);hold; plot(inn(:,1),inn(:,2),&#39;r&#39;);
</pre></div>
</div>
<p>Or in gnuplot:</p>
<div class="last highlight-c"><div class="highlight"><pre>plot &#39;out&#39; w lp, &#39;inn&#39; w lp
</pre></div>
</div>
</div>
<dl class="member">
<dt id="c.primme_params.aNorm">
double <code class="descname">aNorm</code><a class="headerlink" href="#c.primme_params.aNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>An estimate of the norm of <span class="math">\(A\)</span>, which is used in the convergence
criterion (see <a class="reference internal" href="#c.primme_params.eps" title="primme_params.eps"><code class="xref c c-member docutils literal"><span class="pre">eps</span></code></a>).</p>
<p>If <a class="reference internal" href="#c.primme_params.aNorm" title="primme_params.aNorm"><code class="xref c c-member docutils literal"><span class="pre">aNorm</span></code></a> is less than or equal to 0, the code uses the largest absolute
Ritz value seen. On return, <a class="reference internal" href="#c.primme_params.aNorm" title="primme_params.aNorm"><code class="xref c c-member docutils literal"><span class="pre">aNorm</span></code></a> is then replaced with that value.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0.0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.eps">
double <code class="descname">eps</code><a class="headerlink" href="#c.primme_params.eps" title="Permalink to this definition">¶</a></dt>
<dd><p>An eigenpairs is marked as converged when the 2-norm of the residual is less
than <a class="reference internal" href="#c.primme_params.eps" title="primme_params.eps"><code class="xref c c-member docutils literal"><span class="pre">eps</span></code></a> * <a class="reference internal" href="#c.primme_params.aNorm" title="primme_params.aNorm"><code class="xref c c-member docutils literal"><span class="pre">aNorm</span></code></a>.
The residual vector is <span class="math">\(A x - \lambda x\)</span> or <span class="math">\(A x - \lambda B x\)</span>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to <span class="math">\(10^{-12}\)</span>;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.outputFile">
FILE *<code class="descname">outputFile</code><a class="headerlink" href="#c.primme_params.outputFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Opened file to write down the output.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to the standard output;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.dynamicMethodSwitch">
int <code class="descname">dynamicMethodSwitch</code><a class="headerlink" href="#c.primme_params.dynamicMethodSwitch" title="Permalink to this definition">¶</a></dt>
<dd><p>If this value is 1, it alternates dynamically between <a class="reference internal" href="#c.primme_preset_method.DEFAULT_MIN_TIME" title="primme_preset_method.DEFAULT_MIN_TIME"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_TIME</span></code></a>
and <a class="reference internal" href="#c.primme_preset_method.DEFAULT_MIN_MATVECS" title="primme_preset_method.DEFAULT_MIN_MATVECS"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_MATVECS</span></code></a>, trying to identify the fastest method.</p>
<p>On exit, it holds a recommended method for future runs on this problem:</p>
<blockquote>
<div><div class="line-block">
<div class="line">-1: use <a class="reference internal" href="#c.primme_preset_method.DEFAULT_MIN_MATVECS" title="primme_preset_method.DEFAULT_MIN_MATVECS"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_MATVECS</span></code></a> next time.</div>
<div class="line">-2: use <a class="reference internal" href="#c.primme_preset_method.DEFAULT_MIN_TIME" title="primme_preset_method.DEFAULT_MIN_TIME"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_TIME</span></code></a> next time.</div>
<div class="line">-3: close call, use <a class="reference internal" href="#c.primme_preset_method.DYNAMIC" title="primme_preset_method.DYNAMIC"><code class="xref c c-member docutils literal"><span class="pre">DYNAMIC</span></code></a> next time again.</div>
</div>
</div></blockquote>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Even for expert users we do not recommend setting <a class="reference internal" href="#c.primme_params.dynamicMethodSwitch" title="primme_params.dynamicMethodSwitch"><code class="xref c c-member docutils literal"><span class="pre">dynamicMethodSwitch</span></code></a>
directly, but through <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The code obtains timings by the <code class="docutils literal"><span class="pre">gettimeofday</span></code> Unix utility. If a cheaper, more
accurate timer is available, modify the <code class="docutils literal"><span class="pre">PRIMMESRC/COMMONSRC/wtime.c</span></code></p>
</div>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.locking">
int <code class="descname">locking</code><a class="headerlink" href="#c.primme_params.locking" title="Permalink to this definition">¶</a></dt>
<dd><p>If set to 1, hard locking will be used (locking converged eigenvectors
out of the search basis). Otherwise the code will try to use soft
locking (à la ARPACK), when large enough <a class="reference internal" href="#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a> is available.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.initSize">
int <code class="descname">initSize</code><a class="headerlink" href="#c.primme_params.initSize" title="Permalink to this definition">¶</a></dt>
<dd><p>On input, the number of initial vector guesses provided in <code class="docutils literal"><span class="pre">evecs</span></code> argument in
<a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> or <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a>.</p>
<p>On output, <a class="reference internal" href="#c.primme_params.initSize" title="primme_params.initSize"><code class="xref c c-member docutils literal"><span class="pre">initSize</span></code></a> holds the number of converged eigenpairs. Without <a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a> all
<a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> approximations are in <code class="docutils literal"><span class="pre">evecs</span></code> but only the <a class="reference internal" href="#c.primme_params.initSize" title="primme_params.initSize"><code class="xref c c-member docutils literal"><span class="pre">initSize</span></code></a> ones are
converged.</p>
<p>During execution, it holds the current number of converged eigenpairs.
In addition, if locking is used, these are accessible in <code class="docutils literal"><span class="pre">evals</span></code> and <code class="docutils literal"><span class="pre">evecs</span></code>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.numOrthoConst">
int <code class="descname">numOrthoConst</code><a class="headerlink" href="#c.primme_params.numOrthoConst" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of vectors to be used as external orthogonalization constraints.
These vectors are provided in the first <a class="reference internal" href="#c.primme_params.numOrthoConst" title="primme_params.numOrthoConst"><code class="xref c c-member docutils literal"><span class="pre">numOrthoConst</span></code></a> positions of
the <code class="docutils literal"><span class="pre">evecs</span></code> argument in <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> or <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> and must be orthonormal.</p>
<p>PRIMME finds new eigenvectors orthogonal to these constraints (equivalent to solving
the problem with <span class="math">\((I-YY^*)A(I-YY^*)\)</span> and <span class="math">\((I-YY^*)B(I-YY^*)\)</span> matrices
where <span class="math">\(Y\)</span> are the given constraint vectors).
This is a handy feature if some eigenvectors are already known, or
for finding more eigenvalues after a call to <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> or <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a>,
possibly with different parameters (see an example in <code class="file docutils literal"><span class="pre">TEST/ex_zseq.c</span></code>).</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.maxBasisSize">
int <code class="descname">maxBasisSize</code><a class="headerlink" href="#c.primme_params.maxBasisSize" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum basis size allowed in the main iteration. This has memory
implications.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.minRestartSize">
int <code class="descname">minRestartSize</code><a class="headerlink" href="#c.primme_params.minRestartSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum Ritz vectors kept after restarting the basis.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.maxBlockSize">
int <code class="descname">maxBlockSize</code><a class="headerlink" href="#c.primme_params.maxBlockSize" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum block size the code will try to use.</p>
<p>The user should set
this based on the architecture specifics of the target computer,
as well as any a priori knowledge of multiplicities. The code does
<em>not</em> require that <a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a> &gt; 1 to find multiple eigenvalues. For some
methods, keeping to 1 yields the best overall performance.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 1;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Inner iterations of QMR are not performed in a block fashion.
Every correction equation from a block is solved independently.</p>
</div>
</dd></dl>

<span class="target" id="index-3"></span><dl class="member">
<dt id="c.primme_params.maxMatvecs">
int <code class="descname">maxMatvecs</code><a class="headerlink" href="#c.primme_params.maxMatvecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of matrix vector multiplications (approximately equal to
the number of preconditioning operations) that the code is allowed to
perform before it exits.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to <code class="docutils literal"><span class="pre">INT_MAX</span></code>;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<span class="target" id="index-4"></span><dl class="member">
<dt id="c.primme_params.maxOuterIterations">
int <code class="descname">maxOuterIterations</code><a class="headerlink" href="#c.primme_params.maxOuterIterations" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of outer iterations that the code is allowed to perform
before it exits.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to <code class="docutils literal"><span class="pre">INT_MAX</span></code>;</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.intWorkSize">
int <code class="descname">intWorkSize</code><a class="headerlink" href="#c.primme_params.intWorkSize" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> or <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> is called with all arguments as NULL
except for <a class="reference internal" href="#c.primme_params" title="primme_params"><code class="xref c c-type docutils literal"><span class="pre">primme_params</span></code></a> then PRIMME returns immediately with <a class="reference internal" href="#c.primme_params.intWorkSize" title="primme_params.intWorkSize"><code class="xref c c-member docutils literal"><span class="pre">intWorkSize</span></code></a>
containing the size <em>in bytes</em> of the integer workspace that will be required by the
parameters set in PRIMME.</p>
<p>Otherwise if <a class="reference internal" href="#c.primme_params.intWorkSize" title="primme_params.intWorkSize"><code class="xref c c-member docutils literal"><span class="pre">intWorkSize</span></code></a> is not 0, it should be the size of the integer work array
<em>in bytes</em> that the user provides in <a class="reference internal" href="#c.primme_params.intWork" title="primme_params.intWork"><code class="xref c c-member docutils literal"><span class="pre">intWork</span></code></a>. If <a class="reference internal" href="#c.primme_params.intWorkSize" title="primme_params.intWorkSize"><code class="xref c c-member docutils literal"><span class="pre">intWorkSize</span></code></a> is 0, the code
will allocate the required space, which can be freed later by calling <a class="reference internal" href="readme.html#c.primme_Free" title="primme_Free"><code class="xref c c-func docutils literal"><span class="pre">primme_Free()</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.realWorkSize">
long int <code class="descname">realWorkSize</code><a class="headerlink" href="#c.primme_params.realWorkSize" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> or <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> is called with all arguments as NULL
except for <a class="reference internal" href="#c.primme_params" title="primme_params"><code class="xref c c-type docutils literal"><span class="pre">primme_params</span></code></a> then PRIMME returns immediately with <a class="reference internal" href="#c.primme_params.realWorkSize" title="primme_params.realWorkSize"><code class="xref c c-member docutils literal"><span class="pre">realWorkSize</span></code></a>
containing the size <em>in bytes</em> of the real workspace that will be required by the
parameters set in PRIMME.</p>
<p>Otherwise if <a class="reference internal" href="#c.primme_params.realWorkSize" title="primme_params.realWorkSize"><code class="xref c c-member docutils literal"><span class="pre">realWorkSize</span></code></a> is not 0, it should be the size of the real work array
<em>in bytes</em> that the user provides in <a class="reference internal" href="#c.primme_params.realWork" title="primme_params.realWork"><code class="xref c c-member docutils literal"><span class="pre">realWork</span></code></a>. If <a class="reference internal" href="#c.primme_params.realWorkSize" title="primme_params.realWorkSize"><code class="xref c c-member docutils literal"><span class="pre">realWorkSize</span></code></a> is 0, the code
will allocate the required space, which can be freed later by calling <a class="reference internal" href="readme.html#c.primme_Free" title="primme_Free"><code class="xref c c-func docutils literal"><span class="pre">primme_Free()</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.intWork">
int *<code class="descname">intWork</code><a class="headerlink" href="#c.primme_params.intWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer work array.</p>
<p>If NULL, the code will allocate its own workspace. If the provided space is not
enough, the code will free it and allocate a new space.</p>
<p>On exit, the first element shows if a locking problem has occurred.
Using locking for large <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> may, in some rare cases,
cause some pairs to be practically converged, in the sense that their components
are in the basis of <code class="docutils literal"><span class="pre">evecs</span></code>. If this is the case, a Rayleigh Ritz on returned
<code class="docutils literal"><span class="pre">evecs</span></code> would provide the accurate eigenvectors (see <a class="reference internal" href="readme.html#r4" id="id1">[r4]</a>).</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.realWork">
void *<code class="descname">realWork</code><a class="headerlink" href="#c.primme_params.realWork" title="Permalink to this definition">¶</a></dt>
<dd><p>Real work array.</p>
<p>If NULL, the code will allocate its own workspace. If the provided space is not
enough, the code will free it and allocate a new space.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.iseed">
int <code class="descname">iseed</code><a class="headerlink" href="#c.primme_params.iseed" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal"><span class="pre">int</span> <span class="pre">iseed[4]</span></code> is an array with the seeds needed by the <a class="reference external" href="http://www.netlib.org/lapack/">LAPACK</a> dlarnv and zlarnv.</p>
<p>The default value is an array with values -1, -1, -1 and -1. In that case, <code class="docutils literal"><span class="pre">iseed</span></code>
is set based on the value of <a class="reference internal" href="#c.primme_params.procID" title="primme_params.procID"><code class="xref c c-member docutils literal"><span class="pre">procID</span></code></a> to avoid every parallel process generating
the same sequence of pseudorandom numbers.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to <code class="docutils literal"><span class="pre">[-1,</span> <span class="pre">-1,</span> <span class="pre">-1,</span> <span class="pre">-1]</span></code>;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.matrix">
void *<code class="descname">matrix</code><a class="headerlink" href="#c.primme_params.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>This field may be used to pass any required information
in the matrix-vector product <a class="reference internal" href="#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.preconditioner">
void *<code class="descname">preconditioner</code><a class="headerlink" href="#c.primme_params.preconditioner" title="Permalink to this definition">¶</a></dt>
<dd><p>This field may be used to pass any required information
in the preconditioner function <a class="reference internal" href="#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to NULL;</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.ShiftsForPreconditioner">
double *<code class="descname">ShiftsForPreconditioner</code><a class="headerlink" href="#c.primme_params.ShiftsForPreconditioner" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of size <code class="docutils literal"><span class="pre">blockSize</span></code> provided during execution of <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> and
<a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> holding
the shifts to be used (if needed) in the preconditioning operation.</p>
<p>For example if the block size is 3,
there will be an array of three shifts in <a class="reference internal" href="#c.primme_params.ShiftsForPreconditioner" title="primme_params.ShiftsForPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">ShiftsForPreconditioner</span></code></a>.
Then the user can invert a shifted preconditioner for each of the
block vectors <span class="math">\((M-ShiftsForPreconditioner_i)^{-1} x_i\)</span>.
Classical Davidson (diagonal) preconditioning is an example of this.</p>
<div class="line-block">
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.restartingParams.scheme">
primme_restartscheme <code class="descname">restartingParams.scheme</code><a class="headerlink" href="#c.primme_params.restartingParams.scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a restarting strategy:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">primme_thick</span></code>, Thick restarting. This is the most efficient and robust
in the general case.</li>
<li><code class="docutils literal"><span class="pre">primme_dtr</span></code>, Dynamic thick restarting. Helpful without
preconditioning but it is expensive to implement.</li>
</ul>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to <a class="reference internal" href="#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">primme_thick</span></code></a>;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.restartingParams.maxPrevRetain">
int <code class="descname">restartingParams.maxPrevRetain</code><a class="headerlink" href="#c.primme_params.restartingParams.maxPrevRetain" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of approximations from previous iteration to be retained
after restart (this is the locally optimal restarting, see <a class="reference internal" href="readme.html#r2" id="id2">[r2]</a>).
The restart size is <a class="reference internal" href="#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a> plus <a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.precondition">
int <code class="descname">correctionParams.precondition</code><a class="headerlink" href="#c.primme_params.correctionParams.precondition" title="Permalink to this definition">¶</a></dt>
<dd><p>Set to 1 to use preconditioning.
Make sure <a class="reference internal" href="#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a> is not NULL then!</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.robustShifts">
int <code class="descname">correctionParams.robustShifts</code><a class="headerlink" href="#c.primme_params.correctionParams.robustShifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Set to 1 to use robust shifting. It tries to avoid stagnation and
misconvergence by providing as shifts in <a class="reference internal" href="#c.primme_params.ShiftsForPreconditioner" title="primme_params.ShiftsForPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">ShiftsForPreconditioner</span></code></a>
the Ritz values displaced by an approximation of the eigenvalue error.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.maxInnerIterations">
int <code class="descname">correctionParams.maxInnerIterations</code><a class="headerlink" href="#c.primme_params.correctionParams.maxInnerIterations" title="Permalink to this definition">¶</a></dt>
<dd><p>Control the maximum number of inner QMR iterations:</p>
<ul class="simple">
<li>0:  no inner iterations;</li>
<li>&gt;0: perform at most that number of inner iterations per outer step;</li>
<li>&lt;0: perform at most the rest of the remaining matrix-vector products
up to reach <a class="reference internal" href="#c.primme_params.maxMatvecs" title="primme_params.maxMatvecs"><code class="xref c c-member docutils literal"><span class="pre">maxMatvecs</span></code></a>.</li>
</ul>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">this field is read and written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<p>See also <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a>.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.relTolBase">
double <code class="descname">correctionParams.relTolBase</code><a class="headerlink" href="#c.primme_params.correctionParams.relTolBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter used when <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a>
is <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_decreasing_LTolerance</span></code></a>.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.convTest">
primme_convergencetest <code class="descname">correctionParams.convTest</code><a class="headerlink" href="#c.primme_params.correctionParams.convTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Set how to stop the inner QMR method:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">primme_full_LTolerance</span></code>: stop by iterations only;</li>
<li><code class="docutils literal"><span class="pre">primme_decreasing_LTolerance</span></code>, stop when
<span class="math">\(\text{relTolBase}^{-\text{outIts}}\)</span> where outIts
is the number of outer iterations and retTolBase is set in
<a class="reference internal" href="#c.primme_params.correctionParams.relTolBase" title="primme_params.correctionParams.relTolBase"><code class="xref c c-member docutils literal"><span class="pre">relTolBase</span></code></a>;
This is a legacy option from classical JDQR and we recommend
<strong>strongly</strong> against its use.</li>
<li><code class="docutils literal"><span class="pre">primme_adaptive</span></code>, stop when the estimated eigenvalue residual
has reached the required tolerance (based on Notay&#8217;s JDCG).</li>
<li><code class="docutils literal"><span class="pre">primme_adaptive_ETolerance</span></code>, as <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_adaptive</span></code></a> but also
stopping when the estimated eigenvalue residual has reduced 10
times.</li>
</ul>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to <code class="docutils literal"><span class="pre">primme_adaptive_ETolerance</span></code>;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Avoid to set <a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> to -1 and <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a> to <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_full_LTolerance</span></code></a>.</p>
</div>
<p>See also <a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a>.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.projectors.LeftQ">
int <code class="descname">correctionParams.projectors.LeftQ</code><a class="headerlink" href="#c.primme_params.correctionParams.projectors.LeftQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.projectors.LeftX">
int <code class="descname">correctionParams.projectors.LeftX</code><a class="headerlink" href="#c.primme_params.correctionParams.projectors.LeftX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.projectors.RightQ">
int <code class="descname">correctionParams.projectors.RightQ</code><a class="headerlink" href="#c.primme_params.correctionParams.projectors.RightQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.projectors.RightX">
int <code class="descname">correctionParams.projectors.RightX</code><a class="headerlink" href="#c.primme_params.correctionParams.projectors.RightX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.projectors.SkewQ">
int <code class="descname">correctionParams.projectors.SkewQ</code><a class="headerlink" href="#c.primme_params.correctionParams.projectors.SkewQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="c.primme_params.correctionParams.projectors.SkewX">
int <code class="descname">correctionParams.projectors.SkewX</code><a class="headerlink" href="#c.primme_params.correctionParams.projectors.SkewX" title="Permalink to this definition">¶</a></dt>
<dd><p>Control the projectors involved in the computation of the correction
appended to the basis every (outer) iteration.</p>
<p>Consider the current selected Ritz value <span class="math">\(\Lambda\)</span> and vectors <span class="math">\(X\)</span>,
the residual associated vectors <span class="math">\(R=AX-X\Lambda\)</span>, the previous locked vectors
<span class="math">\(Q\)</span>, and the preconditioner <span class="math">\(M^{-1}\)</span>.</p>
<p>When <a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> is 0, the correction <span class="math">\(D\)</span> appended to the basis
in GD is:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="9%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">RightX</th>
<th class="head">SkewX</th>
<th class="head"><span class="math">\(D\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td><span class="math">\(M^{-1}R\)</span> (Classic GD)</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>0</td>
<td><span class="math">\(M^{-1}(R-\Delta X)\)</span> (cheap Olsen&#8217;s Method)</td>
</tr>
<tr class="row-even"><td>1</td>
<td>1</td>
<td><span class="math">\((I- M^{-1}X(X^*M^{-1}X)^{-1}X^*)M^{-1}R\)</span> (Olsen&#8217;s Method)</td>
</tr>
<tr class="row-odd"><td>0</td>
<td>1</td>
<td>error</td>
</tr>
</tbody>
</table>
<p>Where <span class="math">\(\Delta\)</span> is a diagonal matrix that <span class="math">\(\Delta_{i,i}\)</span> holds an estimation
of the error of the approximate eigenvalue <span class="math">\(\Lambda_{i,i}\)</span>.</p>
<p>The values of <code class="docutils literal"><span class="pre">RightQ</span></code>, <code class="docutils literal"><span class="pre">SkewQ</span></code>, <code class="docutils literal"><span class="pre">LeftX</span></code> and <code class="docutils literal"><span class="pre">LeftQ</span></code> are ignored.</p>
<p>When <a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> is not 0, the correction <span class="math">\(D\)</span> in Jacobi-Davidson results
from solving:</p>
<div class="math">
\[P_Q^l P_X^l (A-\sigma I) P_X^r P_Q^r M^{-1} D' = -R, \ \ \  D = P_X^r P_Q^l M^{-1}D'.\]</div>
<p>For <code class="docutils literal"><span class="pre">LeftQ</span></code>:</p>
<blockquote>
<div><div class="line-block">
<div class="line">0: <span class="math">\(P_Q^l = I\)</span>;</div>
<div class="line">1: <span class="math">\(P_Q^l = I - QQ^*\)</span>.</div>
</div>
</div></blockquote>
<p>For <code class="docutils literal"><span class="pre">LeftX</span></code>:</p>
<blockquote>
<div><div class="line-block">
<div class="line">0: <span class="math">\(P_X^l = I\)</span>;</div>
<div class="line">1: <span class="math">\(P_X^l = I - XX^*\)</span>.</div>
</div>
</div></blockquote>
<p>For <code class="docutils literal"><span class="pre">RightQ</span></code> and <code class="docutils literal"><span class="pre">SkewQ</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="15%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">RightQ</th>
<th class="head">SkewQ</th>
<th class="head"><span class="math">\(P_Q^r\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td><span class="math">\(I\)</span></td>
</tr>
<tr class="row-odd"><td>1</td>
<td>0</td>
<td><span class="math">\(I - QQ^*\)</span></td>
</tr>
<tr class="row-even"><td>1</td>
<td>1</td>
<td><span class="math">\(I - KQ(Q^*KQ)^{-1}Q^*\)</span></td>
</tr>
<tr class="row-odd"><td>0</td>
<td>1</td>
<td>error</td>
</tr>
</tbody>
</table>
<p>For <code class="docutils literal"><span class="pre">RightX</span></code> and <code class="docutils literal"><span class="pre">SkewX</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="15%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">RightX</th>
<th class="head">SkewX</th>
<th class="head"><span class="math">\(P_X^r\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td><span class="math">\(I\)</span></td>
</tr>
<tr class="row-odd"><td>1</td>
<td>0</td>
<td><span class="math">\(I - XX^*\)</span></td>
</tr>
<tr class="row-even"><td>1</td>
<td>1</td>
<td><span class="math">\(I - KX(X^*KX)^{-1}X^*\)</span></td>
</tr>
<tr class="row-odd"><td>0</td>
<td>1</td>
<td>error</td>
</tr>
</tbody>
</table>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets all of them to 0;</div>
<div class="line">this field is written by <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> (see <a class="reference internal" href="#methods"><span>Preset Methods</span></a>);</div>
<div class="line">this field is read by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
<p>See <a class="reference internal" href="readme.html#r3" id="id3">[r3]</a> for a study about different projector configurations in JD.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.stats.numOuterIterations">
int <code class="descname">stats.numOuterIterations</code><a class="headerlink" href="#c.primme_params.stats.numOuterIterations" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold the number of outer iterations. The value is available during execution and at the end.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.stats.numRestarts">
int <code class="descname">stats.numRestarts</code><a class="headerlink" href="#c.primme_params.stats.numRestarts" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold the number of restarts during execution and at the end.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.stats.numMatvecs">
int <code class="descname">stats.numMatvecs</code><a class="headerlink" href="#c.primme_params.stats.numMatvecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold how many vectors the operator in <a class="reference internal" href="#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a> has been applied on.
The value is available during execution and at the end.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.stats.numPreconds">
int <code class="descname">stats.numPreconds</code><a class="headerlink" href="#c.primme_params.stats.numPreconds" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold how many vectors the operator in <a class="reference internal" href="#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a> has been applied on.
The value is available during execution and at the end.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

<dl class="member">
<dt id="c.primme_params.stats.elapsedTime">
int <code class="descname">stats.elapsedTime</code><a class="headerlink" href="#c.primme_params.stats.elapsedTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold the wall clock time spent by the call to <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> or <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a>.
The value is available at the end of the execution.</p>
<p>Input/output:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="readme.html#c.primme_initialize" title="primme_initialize"><code class="xref c c-func docutils literal"><span class="pre">primme_initialize()</span></code></a> sets this field to 0;</div>
<div class="line">written by <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a>.</div>
</div>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="error-codes">
<span id="id4"></span><h3>Error Codes<a class="headerlink" href="#error-codes" title="Permalink to this headline">¶</a></h3>
<p>The functions <a class="reference internal" href="readme.html#c.dprimme" title="dprimme"><code class="xref c c-func docutils literal"><span class="pre">dprimme()</span></code></a> and <a class="reference internal" href="readme.html#c.zprimme" title="zprimme"><code class="xref c c-func docutils literal"><span class="pre">zprimme()</span></code></a> return one of the next values:</p>
<ul class="simple">
<li>0: success.</li>
<li>1: reported only amount of required memory.</li>
<li>-1: failed in allocating int or real workspace.</li>
<li>-2: malloc failed in allocating a permutation integer array.</li>
<li>-3: main_iter() encountered problem; the calling stack of the
functions where the error occurred was printed in <code class="docutils literal"><span class="pre">stderr</span></code>.</li>
<li>-4: if argument <code class="docutils literal"><span class="pre">primme</span></code> is NULL.</li>
<li>-5: if <a class="reference internal" href="#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">n</span></code></a> &lt;= 0 or <a class="reference internal" href="#c.primme_params.nLocal" title="primme_params.nLocal"><code class="xref c c-member docutils literal"><span class="pre">nLocal</span></code></a> &lt;= 0.</li>
<li>-6: if <a class="reference internal" href="#c.primme_params.numProcs" title="primme_params.numProcs"><code class="xref c c-member docutils literal"><span class="pre">numProcs</span></code></a> &lt; 1.</li>
<li>-7: if <a class="reference internal" href="#c.primme_params.matrixMatvec" title="primme_params.matrixMatvec"><code class="xref c c-member docutils literal"><span class="pre">matrixMatvec</span></code></a> is NULL.</li>
<li>-8: if <a class="reference internal" href="#c.primme_params.applyPreconditioner" title="primme_params.applyPreconditioner"><code class="xref c c-member docutils literal"><span class="pre">applyPreconditioner</span></code></a> is NULL and
<a class="reference internal" href="#c.primme_params.correctionParams.precondition" title="primme_params.correctionParams.precondition"><code class="xref c c-member docutils literal"><span class="pre">precondition</span></code></a> is not NULL.</li>
<li>-9: if <a class="reference internal" href="#c.primme_params.globalSumDouble" title="primme_params.globalSumDouble"><code class="xref c c-member docutils literal"><span class="pre">globalSumDouble</span></code></a> is NULL.</li>
<li>-10: if <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> &gt; <a class="reference internal" href="#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">n</span></code></a>.</li>
<li>-11: if <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> &lt; 0.</li>
<li>-12: if <a class="reference internal" href="#c.primme_params.eps" title="primme_params.eps"><code class="xref c c-member docutils literal"><span class="pre">eps</span></code></a> &gt; 0 and <a class="reference internal" href="#c.primme_params.eps" title="primme_params.eps"><code class="xref c c-member docutils literal"><span class="pre">eps</span></code></a> &lt; machine precision.</li>
<li>-13: if <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">target</span></code></a> is not properly defined.</li>
<li>-14: if <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">target</span></code></a> is one of <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_geq</span></code></a>,
<a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_leq</span></code></a> or <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_abs</span></code></a> but
<a class="reference internal" href="#c.primme_params.numTargetShifts" title="primme_params.numTargetShifts"><code class="xref c c-member docutils literal"><span class="pre">numTargetShifts</span></code></a> &lt;= 0 (no shifts).</li>
<li>-15: if <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">target</span></code></a> is one of <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_geq</span></code></a>,
<a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_leq</span></code></a> or <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">primme_closest_abs</span></code></a> but
<a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a> is NULL  (no shifts array).</li>
<li>-16: if <a class="reference internal" href="#c.primme_params.numOrthoConst" title="primme_params.numOrthoConst"><code class="xref c c-member docutils literal"><span class="pre">numOrthoConst</span></code></a> &lt; 0 or
<a class="reference internal" href="#c.primme_params.numOrthoConst" title="primme_params.numOrthoConst"><code class="xref c c-member docutils literal"><span class="pre">numOrthoConst</span></code></a> &gt;= <a class="reference internal" href="#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">n</span></code></a>.
(no free dimensions left).</li>
<li>-17: if <a class="reference internal" href="#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a> &lt; 2.</li>
<li>-18: if <a class="reference internal" href="#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a> &lt;= 0.</li>
<li>-19: if <a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a> &lt;= 0.</li>
<li>-20: if <a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a> &lt; 0.</li>
<li>-21: if <a class="reference internal" href="#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">scheme</span></code></a> is not one of <cite>primme_thick</cite> or <cite>primme_dtr</cite>.</li>
<li>-22: if <a class="reference internal" href="#c.primme_params.initSize" title="primme_params.initSize"><code class="xref c c-member docutils literal"><span class="pre">initSize</span></code></a> &lt; 0.</li>
<li>-23: if not <a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a> and <a class="reference internal" href="#c.primme_params.initSize" title="primme_params.initSize"><code class="xref c c-member docutils literal"><span class="pre">initSize</span></code></a> &gt; <a class="reference internal" href="#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a>.</li>
<li>-24: if <a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a> and <a class="reference internal" href="#c.primme_params.initSize" title="primme_params.initSize"><code class="xref c c-member docutils literal"><span class="pre">initSize</span></code></a> &gt; <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>.</li>
<li>-25: if <a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a> + <a class="reference internal" href="#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a> &gt;= <a class="reference internal" href="#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a>.</li>
<li>-26: if <a class="reference internal" href="#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a> &gt;= <a class="reference internal" href="#c.primme_params.n" title="primme_params.n"><code class="xref c c-member docutils literal"><span class="pre">n</span></code></a>.</li>
<li>-27: if <a class="reference internal" href="#c.primme_params.printLevel" title="primme_params.printLevel"><code class="xref c c-member docutils literal"><span class="pre">printLevel</span></code></a> &lt; 0 or <a class="reference internal" href="#c.primme_params.printLevel" title="primme_params.printLevel"><code class="xref c c-member docutils literal"><span class="pre">printLevel</span></code></a> &gt; 5.</li>
<li>-28: if <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a> is not one of
<a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_full_LTolerance</span></code></a>, <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_decreasing_LTolerance</span></code></a>,
<a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_adaptive_ETolerance</span></code></a> or <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_adaptive</span></code></a>.</li>
<li>-29: if <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a> == <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_decreasing_LTolerance</span></code></a> and <a class="reference internal" href="#c.primme_params.correctionParams.relTolBase" title="primme_params.correctionParams.relTolBase"><code class="xref c c-member docutils literal"><span class="pre">relTolBase</span></code></a> &lt;= 1.</li>
<li>-30: if <code class="docutils literal"><span class="pre">evals</span></code> is NULL, but not <code class="docutils literal"><span class="pre">evecs</span></code> and <code class="docutils literal"><span class="pre">resNorms</span></code>.</li>
<li>-31: if <code class="docutils literal"><span class="pre">evecs</span></code> is NULL, but not <code class="docutils literal"><span class="pre">evals</span></code> and <code class="docutils literal"><span class="pre">resNorms</span></code>.</li>
<li>-32: if <code class="docutils literal"><span class="pre">resNorms</span></code> is NULL, but not <code class="docutils literal"><span class="pre">evecs</span></code> and <code class="docutils literal"><span class="pre">evals</span></code>.</li>
</ul>
</div>
<div class="section" id="preset-methods">
<span id="methods"></span><h3>Preset Methods<a class="headerlink" href="#preset-methods" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="c.primme_preset_method">
<code class="descname">primme_preset_method</code><a class="headerlink" href="#c.primme_preset_method" title="Permalink to this definition">¶</a></dt>
<dd><dl class="member">
<dt id="c.primme_preset_method.DEFAULT_MIN_TIME">
<code class="descname">DEFAULT_MIN_TIME</code><a class="headerlink" href="#c.primme_preset_method.DEFAULT_MIN_TIME" title="Permalink to this definition">¶</a></dt>
<dd><p>Set as <a class="reference internal" href="#c.primme_preset_method.JDQMR_ETol" title="primme_preset_method.JDQMR_ETol"><code class="xref c c-member docutils literal"><span class="pre">JDQMR_ETol</span></code></a> when <a class="reference internal" href="#c.primme_params.target" title="primme_params.target"><code class="xref c c-member docutils literal"><span class="pre">target</span></code></a> is either <code class="docutils literal"><span class="pre">primme_smallest</span></code> or
<code class="docutils literal"><span class="pre">primme_largest</span></code>, and as <a class="reference internal" href="#c.primme_preset_method.JDQMR" title="primme_preset_method.JDQMR"><code class="xref c c-member docutils literal"><span class="pre">JDQMR</span></code></a> otherwise. This method is usually
the fastest if the cost of the matrix vector product is inexpensive.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.DEFAULT_MIN_MATVECS">
<code class="descname">DEFAULT_MIN_MATVECS</code><a class="headerlink" href="#c.primme_preset_method.DEFAULT_MIN_MATVECS" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently set as <a class="reference internal" href="#c.primme_preset_method.GD_Olsen_plusK" title="primme_preset_method.GD_Olsen_plusK"><code class="xref c c-member docutils literal"><span class="pre">GD_Olsen_plusK</span></code></a>; this method usually performs
fewer matrix vector products than other methods, so it&#8217;s a good
choice when this operation is expensive.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.DYNAMIC">
<code class="descname">DYNAMIC</code><a class="headerlink" href="#c.primme_preset_method.DYNAMIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Switches to the best method dynamically; currently, between
methods <a class="reference internal" href="#c.primme_preset_method.DEFAULT_MIN_TIME" title="primme_preset_method.DEFAULT_MIN_TIME"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_TIME</span></code></a> and <a class="reference internal" href="#c.primme_preset_method.DEFAULT_MIN_MATVECS" title="primme_preset_method.DEFAULT_MIN_MATVECS"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_MATVECS</span></code></a>.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.DYNAMIC" title="primme_preset_method.DYNAMIC"><code class="xref c c-member docutils literal"><span class="pre">DYNAMIC</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets
<a class="reference internal" href="#c.primme_params.dynamicMethodSwitch" title="primme_params.dynamicMethodSwitch"><code class="xref c c-member docutils literal"><span class="pre">dynamicMethodSwitch</span></code></a> = 1 and makes the same changes as
for method <a class="reference internal" href="#c.primme_preset_method.DEFAULT_MIN_TIME" title="primme_preset_method.DEFAULT_MIN_TIME"><code class="xref c c-member docutils literal"><span class="pre">DEFAULT_MIN_TIME</span></code></a>.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.Arnoldi">
<code class="descname">Arnoldi</code><a class="headerlink" href="#c.primme_preset_method.Arnoldi" title="Permalink to this definition">¶</a></dt>
<dd><p>Arnoldi implemented à la Generalized Davidson.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.Arnoldi" title="primme_preset_method.Arnoldi"><code class="xref c c-member docutils literal"><span class="pre">Arnoldi</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a> = 0;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.correctionParams.precondition" title="primme_params.correctionParams.precondition"><code class="xref c c-member docutils literal"><span class="pre">precondition</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = 0.</li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.GD">
<code class="descname">GD</code><a class="headerlink" href="#c.primme_preset_method.GD" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalized Davidson.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.GD" title="primme_preset_method.GD"><code class="xref c c-member docutils literal"><span class="pre">GD</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.robustShifts" title="primme_params.correctionParams.robustShifts"><code class="xref c c-member docutils literal"><span class="pre">robustShifts</span></code></a> = 1;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a> = 0.</li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.GD_plusK">
<code class="descname">GD_plusK</code><a class="headerlink" href="#c.primme_preset_method.GD_plusK" title="Permalink to this definition">¶</a></dt>
<dd><p>GD with locally optimal restarting.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.GD_plusK" title="primme_preset_method.GD_plusK"><code class="xref c c-member docutils literal"><span class="pre">GD_plusK</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets
<a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a> = 2 if <a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a> is 1 and <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> &gt; 1;
otherwise it sets <a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a> to <a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a>. Also:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = 0;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a> = 0.</li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.GD_Olsen_plusK">
<code class="descname">GD_Olsen_plusK</code><a class="headerlink" href="#c.primme_preset_method.GD_Olsen_plusK" title="Permalink to this definition">¶</a></dt>
<dd><p>GD+k and the cheap Olsen&#8217;s Method.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.GD_Olsen_plusK" title="primme_preset_method.GD_Olsen_plusK"><code class="xref c c-member docutils literal"><span class="pre">GD_Olsen_plusK</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> makes the
same changes as for method <a class="reference internal" href="#c.primme_preset_method.GD_plusK" title="primme_preset_method.GD_plusK"><code class="xref c c-member docutils literal"><span class="pre">GD_plusK</span></code></a> and sets <a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a> = 1.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.JD_Olsen_plusK">
<code class="descname">JD_Olsen_plusK</code><a class="headerlink" href="#c.primme_preset_method.JD_Olsen_plusK" title="Permalink to this definition">¶</a></dt>
<dd><p>GD+k and Olsen&#8217;s Method.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.JD_Olsen_plusK" title="primme_preset_method.JD_Olsen_plusK"><code class="xref c c-member docutils literal"><span class="pre">JD_Olsen_plusK</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> makes the
same changes as for method <a class="reference internal" href="#c.primme_preset_method.GD_plusK" title="primme_preset_method.GD_plusK"><code class="xref c c-member docutils literal"><span class="pre">GD_plusK</span></code></a> and also sets
<a class="reference internal" href="#c.primme_params.correctionParams.robustShifts" title="primme_params.correctionParams.robustShifts"><code class="xref c c-member docutils literal"><span class="pre">robustShifts</span></code></a> = 1, <a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a> to 1, and <a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a> to 1.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.RQI">
<code class="descname">RQI</code><a class="headerlink" href="#c.primme_preset_method.RQI" title="Permalink to this definition">¶</a></dt>
<dd><p>(Accelerated) Rayleigh Quotient Iteration.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.RQI" title="primme_preset_method.RQI"><code class="xref c c-member docutils literal"><span class="pre">RQI</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a> = 1;</li>
<li><a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.robustShifts" title="primme_params.correctionParams.robustShifts"><code class="xref c c-member docutils literal"><span class="pre">robustShifts</span></code></a>  = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = -1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.LeftQ" title="primme_params.correctionParams.projectors.LeftQ"><code class="xref c c-member docutils literal"><span class="pre">LeftQ</span></code></a>   = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.LeftX" title="primme_params.correctionParams.projectors.LeftX"><code class="xref c c-member docutils literal"><span class="pre">LeftX</span></code></a>   = 1;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightQ" title="primme_params.correctionParams.projectors.RightQ"><code class="xref c c-member docutils literal"><span class="pre">RightQ</span></code></a>  = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a>  = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewQ" title="primme_params.correctionParams.projectors.SkewQ"><code class="xref c c-member docutils literal"><span class="pre">SkewQ</span></code></a>   = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a>   = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a> = <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_full_LTolerance</span></code></a>.</li>
</ul>
</td></tr></table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <a class="reference internal" href="#c.primme_params.numTargetShifts" title="primme_params.numTargetShifts"><code class="xref c c-member docutils literal"><span class="pre">numTargetShifts</span></code></a> &gt; 0 and <a class="reference internal" href="#c.primme_params.targetShifts" title="primme_params.targetShifts"><code class="xref c c-member docutils literal"><span class="pre">targetShifts</span></code></a> are provided, the interior problem
solved uses these shifts in the correction equation. Therefore RQI becomes
INVIT (inverse iteration) in that case.</p>
</div>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.JDQR">
<code class="descname">JDQR</code><a class="headerlink" href="#c.primme_preset_method.JDQR" title="Permalink to this definition">¶</a></dt>
<dd><p>Jacobi-Davidson with fixed number of inner steps.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.JDQR" title="primme_preset_method.JDQR"><code class="xref c c-member docutils literal"><span class="pre">JDQR</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a>     = 1;</li>
<li><a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a>      = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.robustShifts" title="primme_params.correctionParams.robustShifts"><code class="xref c c-member docutils literal"><span class="pre">robustShifts</span></code></a>       = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = 10 if it is 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.LeftQ" title="primme_params.correctionParams.projectors.LeftQ"><code class="xref c c-member docutils literal"><span class="pre">LeftQ</span></code></a>   = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.LeftX" title="primme_params.correctionParams.projectors.LeftX"><code class="xref c c-member docutils literal"><span class="pre">LeftX</span></code></a>   = 1;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightQ" title="primme_params.correctionParams.projectors.RightQ"><code class="xref c c-member docutils literal"><span class="pre">RightQ</span></code></a>  = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a>  = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewQ" title="primme_params.correctionParams.projectors.SkewQ"><code class="xref c c-member docutils literal"><span class="pre">SkewQ</span></code></a>   = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a>   = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.relTolBase" title="primme_params.correctionParams.relTolBase"><code class="xref c c-member docutils literal"><span class="pre">relTolBase</span></code></a> = 1.5;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a> = <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_full_LTolerance</span></code></a>.</li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.JDQMR">
<code class="descname">JDQMR</code><a class="headerlink" href="#c.primme_preset_method.JDQMR" title="Permalink to this definition">¶</a></dt>
<dd><p>Jacobi-Davidson with adaptive stopping criterion for inner Quasi Minimum Residual (QMR).</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.JDQMR" title="primme_preset_method.JDQMR"><code class="xref c c-member docutils literal"><span class="pre">JDQMR</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a> = 1 if it is 0</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = -1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.LeftQ" title="primme_params.correctionParams.projectors.LeftQ"><code class="xref c c-member docutils literal"><span class="pre">LeftQ</span></code></a>   = <a class="reference internal" href="#c.primme_params.correctionParams.precondition" title="primme_params.correctionParams.precondition"><code class="xref c c-member docutils literal"><span class="pre">precondition</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.LeftX" title="primme_params.correctionParams.projectors.LeftX"><code class="xref c c-member docutils literal"><span class="pre">LeftX</span></code></a>   = 1;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightQ" title="primme_params.correctionParams.projectors.RightQ"><code class="xref c c-member docutils literal"><span class="pre">RightQ</span></code></a>  = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a>  = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewQ" title="primme_params.correctionParams.projectors.SkewQ"><code class="xref c c-member docutils literal"><span class="pre">SkewQ</span></code></a>   = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a>   = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a>  = <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_adaptive</span></code></a>.</li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.JDQMR_ETol">
<code class="descname">JDQMR_ETol</code><a class="headerlink" href="#c.primme_preset_method.JDQMR_ETol" title="Permalink to this definition">¶</a></dt>
<dd><p>JDQMR but QMR stops after residual norm reduces by a 0.1 factor.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.JDQMR_ETol" title="primme_preset_method.JDQMR_ETol"><code class="xref c c-member docutils literal"><span class="pre">JDQMR_ETol</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> makes the same
changes as for the method <a class="reference internal" href="#c.primme_preset_method.JDQMR" title="primme_preset_method.JDQMR"><code class="xref c c-member docutils literal"><span class="pre">JDQMR</span></code></a> and sets
<a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">convTest</span></code></a> = <a class="reference internal" href="#c.primme_params.correctionParams.convTest" title="primme_params.correctionParams.convTest"><code class="xref c c-member docutils literal"><span class="pre">primme_adaptive_ETolerance</span></code></a>.</p>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.SUBSPACE_ITERATION">
<code class="descname">SUBSPACE_ITERATION</code><a class="headerlink" href="#c.primme_preset_method.SUBSPACE_ITERATION" title="Permalink to this definition">¶</a></dt>
<dd><p>Subspace iteration.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.SUBSPACE_ITERATION" title="primme_preset_method.SUBSPACE_ITERATION"><code class="xref c c-member docutils literal"><span class="pre">SUBSPACE_ITERATION</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a>    = 1;</li>
<li><a class="reference internal" href="#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a> = <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> <cite>*</cite> 2;</li>
<li><a class="reference internal" href="#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a> = <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a> = <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">scheme</span></code></a>  = <a class="reference internal" href="#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">primme_thick</span></code></a>;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a>      = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.robustShifts" title="primme_params.correctionParams.robustShifts"><code class="xref c c-member docutils literal"><span class="pre">robustShifts</span></code></a>       = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a>  = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a>   = 0.</li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.LOBPCG_OrthoBasis">
<code class="descname">LOBPCG_OrthoBasis</code><a class="headerlink" href="#c.primme_preset_method.LOBPCG_OrthoBasis" title="Permalink to this definition">¶</a></dt>
<dd><p>LOBPCG with orthogonal basis.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.LOBPCG_OrthoBasis" title="primme_preset_method.LOBPCG_OrthoBasis"><code class="xref c c-member docutils literal"><span class="pre">LOBPCG_OrthoBasis</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a>    = 0;</li>
<li><a class="reference internal" href="#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a> = <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a> <cite>*</cite> 3;</li>
<li><a class="reference internal" href="#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a> = <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a> = <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">scheme</span></code></a>  = <a class="reference internal" href="#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">primme_thick</span></code></a>;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a>      = <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.robustShifts" title="primme_params.correctionParams.robustShifts"><code class="xref c c-member docutils literal"><span class="pre">robustShifts</span></code></a>       = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a>  = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a>   = 0.</li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="member">
<dt id="c.primme_preset_method.LOBPCG_OrthoBasis_Window">
<code class="descname">LOBPCG_OrthoBasis_Window</code><a class="headerlink" href="#c.primme_preset_method.LOBPCG_OrthoBasis_Window" title="Permalink to this definition">¶</a></dt>
<dd><p>LOBPCG with sliding window of <a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a> &lt; 3 <cite>*</cite> <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>.</p>
<p>With <a class="reference internal" href="#c.primme_preset_method.LOBPCG_OrthoBasis_Window" title="primme_preset_method.LOBPCG_OrthoBasis_Window"><code class="xref c c-member docutils literal"><span class="pre">LOBPCG_OrthoBasis_Window</span></code></a> <a class="reference internal" href="readme.html#c.primme_set_method" title="primme_set_method"><code class="xref c c-func docutils literal"><span class="pre">primme_set_method()</span></code></a> sets:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.locking" title="primme_params.locking"><code class="xref c c-member docutils literal"><span class="pre">locking</span></code></a>    = 0;</li>
<li><a class="reference internal" href="#c.primme_params.maxBasisSize" title="primme_params.maxBasisSize"><code class="xref c c-member docutils literal"><span class="pre">maxBasisSize</span></code></a> = <a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a> <cite>*</cite> 3;</li>
<li><a class="reference internal" href="#c.primme_params.minRestartSize" title="primme_params.minRestartSize"><code class="xref c c-member docutils literal"><span class="pre">minRestartSize</span></code></a> = <a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a> = <a class="reference internal" href="#c.primme_params.numEvals" title="primme_params.numEvals"><code class="xref c c-member docutils literal"><span class="pre">numEvals</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">scheme</span></code></a>  = <a class="reference internal" href="#c.primme_params.restartingParams.scheme" title="primme_params.restartingParams.scheme"><code class="xref c c-member docutils literal"><span class="pre">primme_thick</span></code></a>;</li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.primme_params.restartingParams.maxPrevRetain" title="primme_params.restartingParams.maxPrevRetain"><code class="xref c c-member docutils literal"><span class="pre">maxPrevRetain</span></code></a>      = <a class="reference internal" href="#c.primme_params.maxBlockSize" title="primme_params.maxBlockSize"><code class="xref c c-member docutils literal"><span class="pre">maxBlockSize</span></code></a>;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.robustShifts" title="primme_params.correctionParams.robustShifts"><code class="xref c c-member docutils literal"><span class="pre">robustShifts</span></code></a>       = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.maxInnerIterations" title="primme_params.correctionParams.maxInnerIterations"><code class="xref c c-member docutils literal"><span class="pre">maxInnerIterations</span></code></a> = 0;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.RightX" title="primme_params.correctionParams.projectors.RightX"><code class="xref c c-member docutils literal"><span class="pre">RightX</span></code></a>  = 1;</li>
<li><a class="reference internal" href="#c.primme_params.correctionParams.projectors.SkewX" title="primme_params.correctionParams.projectors.SkewX"><code class="xref c c-member docutils literal"><span class="pre">SkewX</span></code></a>   = 0.</li>
</ul>
</td></tr></table>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="readme.html#document-readme">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="readme.html#document-intro">PRIMME: PReconditioned Iterative MultiMethod Eigensolver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="readme.html#changelog">Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#citing-this-code">Citing this code</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#license-information">License Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#contact-information">Contact Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#directory-structure">Directory Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#making-and-linking">Making and Linking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="readme.html#considerations-using-an-ide">Considerations using an IDE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#tested-systems">Tested Systems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#document-primmec">C Library Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="readme.html#running">Running</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#parameters-guide">Parameters Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#interface-description">Interface Description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="readme.html#dprimme">dprimme</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#zprimme">zprimme</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#primme-initialize">primme_initialize</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#primme-set-method">primme_set_method</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#primme-display-params">primme_display_params</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#primme-free">primme_Free</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#document-primmef77">FORTRAN Library Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primme-initialize-f77">primme_initialize_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primme-set-method-f77">primme_set_method_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primme-free-f77">primme_Free_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#dprimme-f77">dprimme_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#zprimme-f77">zprimme_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primmetop-set-member-f77">primmetop_set_member_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primmetop-get-member-f77">primmetop_get_member_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primmetop-get-prec-shift-f77">primmetop_get_prec_shift_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primme-set-member-f77">primme_set_member_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primme-get-member-f77">primme_get_member_f77</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primme-get-prec-shift-f77">primme_get_prec_shift_f77</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#document-appendix">Appendix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="readme.html#primme-params">primme_params</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#error-codes">Error Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#preset-methods">Preset Methods</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="readme.html#document-readme">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, College of William & Mary.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
    </div>

    

    
  </body>
</html>